{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header Section -->
    <section class="py-16 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl font-bold text-gray-800 mb-4">Convonet Voice AI Productivity System</h1>
                <p class="text-xl text-gray-600 mb-4">LangGraph + Twilio + MCP + Team Management + Call Transfer + Sentry Monitoring + Redis + Composio + Audio Stream Player + WebRTC Voice Integration</p>
                
                <!-- GitHub Repository Link -->
                <div class="mb-6 flex justify-center items-center gap-4">
                    <a href="https://github.com/hjleepapa/convonet" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="inline-flex items-center gap-2 px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-lg transition-colors shadow-md">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="font-semibold">View on GitHub</span>
                    </a>
                    <span class="text-sm text-gray-500">or</span>
                    <a href="https://github.com/hjleepapa/convonet/releases" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       class="text-blue-600 hover:text-blue-800 underline">
                        Latest Release
                    </a>
                </div>
                
                <div class="flex justify-center flex-wrap gap-2">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">Flask</span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">LangGraph</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">MCP (38 Tools)</span>
                    <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">LangChain</span>
                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">Claude 3.5 Sonnet</span>
                    <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">Google Calendar</span>
                    <span class="bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm font-medium">Twilio Voice</span>
                    <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium">JWT Auth</span>
                    <span class="bg-cyan-100 text-cyan-800 px-3 py-1 rounded-full text-sm font-medium">Team Collaboration</span>
                    <span class="bg-teal-100 text-teal-800 px-3 py-1 rounded-full text-sm font-medium">FusionPBX Call Transfer</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">Deepgram STT</span>
                    <span class="bg-rose-100 text-rose-800 px-3 py-1 rounded-full text-sm font-medium">Sentry Monitoring</span>
                    <span class="bg-lime-100 text-lime-800 px-3 py-1 rounded-full text-sm font-medium">WebRTC Call Center</span>
                    <span class="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-medium">Redis Cache</span>
                    <span class="bg-violet-100 text-violet-800 px-3 py-1 rounded-full text-sm font-medium">Composio Tools</span>
                    <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-sm font-medium">Audio Stream Player</span>
                    <span class="bg-sky-100 text-sky-800 px-3 py-1 rounded-full text-sm font-medium">WebRTC Voice</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Technical Architecture Section -->
    <section class="py-16 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Technical Architecture</h2>
            
            <!-- System Architecture Overview -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">System Architecture Overview</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Convonet Team Collaboration Architecture</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <!-- Frontend Layer -->
                                <div class="space-y-4">
                                    <h5 class="text-sm font-bold text-gray-800 text-center">Frontend Layer</h5>
                                    <div class="space-y-2">
                                        <div class="bg-blue-100 border border-blue-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-blue-800">Team Dashboard</div>
                                            <div class="text-xs text-blue-600">User Management</div>
                                        </div>
                                        <div class="bg-green-100 border border-green-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-green-800">Voice Interface</div>
                                            <div class="text-xs text-green-600">Twilio Phone</div>
                                        </div>
                                        <div class="bg-sky-100 border border-sky-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-sky-800">WebRTC Voice</div>
                                            <div class="text-xs text-sky-600">Browser Recording</div>
                                        </div>
                                        <div class="bg-amber-100 border border-amber-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-amber-800">Redis Audio Buffer</div>
                                            <div class="text-xs text-amber-600">Session Storage</div>
                                        </div>
                                        <div class="bg-purple-100 border border-purple-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-purple-800">Registration</div>
                                            <div class="text-xs text-purple-600">JWT Authentication</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Core Processing Layer -->
                                <div class="space-y-4">
                                    <h5 class="text-sm font-bold text-gray-800 text-center">Core Processing Layer</h5>
                                    <div class="space-y-2">
                                        <div class="bg-orange-100 border border-orange-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-orange-800">LangGraph Agent</div>
                                            <div class="text-xs text-orange-600">AI Assistant</div>
                                        </div>
                                        <div class="bg-yellow-100 border border-yellow-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-yellow-800">MCP Tools</div>
                                            <div class="text-xs text-yellow-600">38 Tools (36 DB + 2 Transfer)</div>
                                        </div>
                                        <div class="bg-teal-100 border border-teal-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-teal-800">Call Transfer</div>
                                            <div class="text-xs text-teal-600">AI ‚Üí FusionPBX</div>
                                        </div>
                                        <div class="bg-rose-100 border border-rose-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-rose-800">Sentry</div>
                                            <div class="text-xs text-rose-600">Error Monitoring</div>
                                        </div>
                                        <div class="bg-pink-100 border border-pink-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-pink-800">Team API</div>
                                            <div class="text-xs text-pink-600">RESTful Endpoints</div>
                                        </div>
                                        <div class="bg-indigo-100 border border-indigo-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-indigo-800">Auth System</div>
                                            <div class="text-xs text-indigo-600">JWT + Bcrypt</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- External Services Layer -->
                                <div class="space-y-4">
                                    <h5 class="text-sm font-bold text-gray-800 text-center">External Services Layer</h5>
                                    <div class="space-y-2">
                                        <div class="bg-red-100 border border-red-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-red-800">Claude & Deepgram APIs</div>
                                            <div class="text-xs text-red-600">GPT-4, TTS</div>
                                        </div>
                                        <div class="bg-gray-100 border border-gray-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-gray-800">PostgreSQL</div>
                                            <div class="text-xs text-gray-600">Multi-tenant DB</div>
                                        </div>
                                        <div class="bg-blue-100 border border-blue-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-blue-800">Google Calendar</div>
                                            <div class="text-xs text-blue-600">OAuth2 Sync</div>
                                        </div>
                                        <div class="bg-cyan-100 border border-cyan-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-cyan-800">Render.com</div>
                                            <div class="text-xs text-cyan-600">Cloud Hosting</div>
                                        </div>
                                        <div class="bg-lime-100 border border-lime-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-lime-800">FusionPBX</div>
                                            <div class="text-xs text-lime-600">Call Center (Google Cloud VM)</div>
                                        </div>
                                        <div class="bg-purple-100 border border-purple-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-purple-800">Deepgram</div>
                                            <div class="text-xs text-purple-600">STT API</div>
                                        </div>
                                        <div class="bg-amber-100 border border-amber-300 rounded p-3 text-center">
                                            <div class="text-xs font-medium text-amber-800">WebRTC/JsSIP</div>
                                            <div class="text-xs text-amber-600">Softphone Client</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Architecture Flow Diagrams -->
                            <div class="mt-6">
                                <h4 class="text-lg font-semibold mb-4 text-gray-800">Complete System Flow Diagrams</h4>
                                
                                <!-- Diagram Links -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                    <div class="bg-white p-6 rounded-lg border-2 border-gray-200 hover:shadow-lg transition-shadow">
                                        <div class="text-center">
                                            <div class="mb-4">
                                                <svg class="w-16 h-16 mx-auto text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
                                                </svg>
                                            </div>
                                            <h5 class="text-lg font-semibold mb-2 text-gray-800">System Architecture Diagram</h5>
                                            <p class="text-sm text-gray-600 mb-4">Complete system flow overview with all components and their relationships</p>
                                            <a href="{{ url_for('convonet_system_architecture') }}" 
                                               class="inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                                View Full Diagram ‚Üí
                                            </a>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-white p-6 rounded-lg border-2 border-gray-200 hover:shadow-lg transition-shadow">
                                        <div class="text-center">
                                            <div class="mb-4">
                                                <svg class="w-16 h-16 mx-auto text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                                </svg>
                                            </div>
                                            <h5 class="text-lg font-semibold mb-2 text-gray-800">Sequence Diagram</h5>
                                            <p class="text-sm text-gray-600 mb-4">Step-by-step flow (52 steps) showing interactions between all components</p>
                                            <a href="{{ url_for('convonet_sequence_diagram') }}" 
                                               class="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                                View Full Diagram ‚Üí
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Quick Flow Summary -->
                                <div class="mt-6 space-y-3">
                                    <div class="flex justify-center">
                                        <div class="text-xs text-gray-600 bg-gray-100 px-4 py-2 rounded-lg max-w-4xl w-full">
                                            <strong>WebRTC Flow:</strong> User Browser ‚Üí PIN Auth (PostgreSQL) ‚Üí Redis Audio Buffer ‚Üí Deepgram STT ‚Üí LangGraph ‚Üí Claude LLM ‚Üí Tool Calling ‚Üí PostgreSQL/Google APIs ‚Üí Deepgram TTS ‚Üí User
                                        </div>
                                    </div>
                                    <div class="flex justify-center">
                                        <div class="text-xs text-gray-600 bg-pink-50 px-4 py-2 rounded-lg max-w-4xl w-full">
                                            <strong>Transfer Flow:</strong> User Request ‚Üí LangGraph (Detect Intent) ‚Üí Twilio API ‚Üí FusionPBX (Extension 2001) ‚Üí Agent Dashboard (JsSIP) ‚Üí User Info Popup ‚Üí Live Conversation
                                        </div>
                                    </div>
                                    <div class="flex justify-center">
                                        <div class="text-xs text-gray-600 bg-rose-50 px-4 py-2 rounded-lg max-w-4xl w-full">
                                            <strong>Monitoring:</strong> All Operations ‚Üí Sentry Monitoring ‚Üí Real-time Alerts & Performance Tracking
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-6 text-center">
                                    <p class="text-sm text-gray-600">
                                        <strong>Architecture Flow:</strong> Enterprise voice AI system with PIN authentication (PostgreSQL), team collaboration, 
                                        intelligent call transfer to FusionPBX call center via Twilio, WebRTC voice integration with Deepgram STT and Redis audio buffering, 
                                        and comprehensive Sentry error monitoring with automatic thread reset recovery (8s/10s/12s timeout optimization).
                                    </p>
                                    <p class="text-sm text-blue-600 mt-3">
                                        <a href="{{ url_for('convonet_system_architecture') }}" class="underline hover:text-blue-800">View System Architecture Diagram</a> | 
                                        <a href="{{ url_for('convonet_sequence_diagram') }}" class="underline hover:text-blue-800">View Sequence Diagram</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Overview -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Overview</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The Convonet Voice AI Productivity System is an enterprise-grade platform that combines 
                        LangGraph AI agents, team collaboration, voice interaction, and intelligent call center integration. 
                        Built for hackathon demonstrations, it showcases advanced features including PIN authentication, 
                        role-based access control, call transfer to FreePBX, and production-grade error monitoring with Sentry.
                        <br><br>
                        The system enables teams to manage todos, assign tasks to members, and collaborate in real-time 
                        through web dashboards, voice commands, and seamless transfer to human agents. Features optimized 
                        timeout handling (8s/10s/12s), automatic thread reset recovery, and comprehensive error tracking.
                        All data is synchronized with Google Calendar using OAuth2 authentication, with intelligent caching 
                        to ensure sub-second voice responses.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Core Technologies</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ LangGraph for agent orchestration with tools_condition</li>
                                <li>‚Ä¢ Model Context Protocol (MCP) - 38 tools (36 DB + 2 transfer)</li>
                                <li>‚Ä¢ LangChain for LLM integration & tool binding</li>
                                <li>‚Ä¢ Flask + Flask-SocketIO for web API & WebSocket</li>
                                <li>‚Ä¢ SQLAlchemy ORM with PostgreSQL (multi-tenant)</li>
                                <li>‚Ä¢ PIN authentication (4-6 digit voice PIN)</li>
                                <li>‚Ä¢ Anthropic Claude API (Claude 3.5 Sonnet)</li>
                                <li>‚Ä¢ Deepgram APIs (STT & TTS)</li>
                                <li>‚Ä¢ Twilio Programmable Voice with Media Streams</li>
                                <li>‚Ä¢ Google Calendar OAuth2 integration (optimized)</li>
                                <li>‚Ä¢ FusionPBX SIP integration for call transfer</li>
                                <li>‚Ä¢ Deepgram Speech-to-Text API for WebRTC</li>
                                <li>‚Ä¢ WebRTC browser-based voice recording</li>
                                <li>‚Ä¢ Sentry.io error monitoring & performance tracking</li>
                                <li>‚Ä¢ JsSIP WebRTC for browser-based softphone</li>
                                <li>‚Ä¢ Render.com auto-deployment with gunicorn+eventlet</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Key Features</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ Multi-tenant team collaboration with role hierarchy</li>
                                <li>‚Ä¢ PIN-based voice authentication (4-6 digits)</li>
                                <li>‚Ä¢ Intelligent call transfer: AI ‚Üí FusionPBX Extension 2001</li>
                                <li>‚Ä¢ WebRTC voice with Deepgram STT transcription</li>
                                <li>‚Ä¢ Redis audio buffer management for WebRTC</li>
                                <li>‚Ä¢ Sentry error monitoring & performance tracking</li>
                                <li>‚Ä¢ Optimized timeouts (8s/10s/12s) for Twilio compatibility</li>
                                <li>‚Ä¢ Automatic thread reset on timeout/error</li>
                                <li>‚Ä¢ 38 MCP tools (todos, calendar, teams, transfer)</li>
                                <li>‚Ä¢ WebRTC call center with JsSIP softphone</li>
                                <li>‚Ä¢ Real-time voice AI with barge-in capability</li>
                                <li>‚Ä¢ Google Calendar OAuth2 sync (background)</li>
                                <li>‚Ä¢ FusionPBX integration on Google Cloud VM</li>
                                <li>‚Ä¢ Production deployment on Render with auto-scaling</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Updates & Improvements -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Recent Updates & Improvements (October 2025)</h3>
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg border-2 border-blue-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Call Transfer Feature -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-teal-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Call Transfer to FusionPBX</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Seamless AI ‚Üí Human agent transfer</li>
                                <li>‚úì FusionPBX extension 2001 integration</li>
                                <li>‚úì SIP/WSS connectivity (Google Cloud VM)</li>
                                <li>‚úì Transfer detection via phrases or tool</li>
                                <li>‚úì Department routing (support, sales, etc.)</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Files:</strong> call_transfer.py, CALL_TRANSFER_GUIDE.md
                            </div>
                        </div>

                        <!-- Deepgram WebRTC Integration -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-purple-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Deepgram WebRTC STT</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Real-time speech-to-text transcription</li>
                                <li>‚úì WebRTC audio stream processing</li>
                                <li>‚úì WebM format detection & handling</li>
                                <li>‚úì High accuracy transcription (95%+)</li>
                                <li>‚úì Low latency (200-500ms)</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Files:</strong> deepgram_service.py, deepgram_webrtc_integration.py
                            </div>
                        </div>

                        <!-- Composio Integration -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-violet-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Composio Integration</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Slack workspace integration</li>
                                <li>‚úì GitHub repository management</li>
                                <li>‚úì Gmail email automation</li>
                                <li>‚úì Notion workspace sync</li>
                                <li>‚úì External platform connectivity</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Files:</strong> COMPOSIO_FEATURES_SUMMARY.md
                            </div>
                        </div>

                        <!-- Sentry Monitoring -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-rose-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-rose-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Sentry Integration</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Real-time error tracking & alerts</li>
                                <li>‚úì Performance monitoring (agent processing time)</li>
                                <li>‚úì User context & session tracking</li>
                                <li>‚úì Timeout & thread reset tracking</li>
                                <li>‚úì Production-grade observability</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Integration:</strong> Flask + SQLAlchemy + Logging
                            </div>
                        </div>

                        <!-- Timeout Optimization -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-green-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Timeout Optimization</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Tool timeout: 8s (from 20s)</li>
                                <li>‚úì Agent timeout: 10s (from 25s)</li>
                                <li>‚úì Webhook timeout: 12s (from 30s)</li>
                                <li>‚úì Stays under Twilio's 15s HTTP limit</li>
                                <li>‚úì Thread reset on timeout prevents errors</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Result:</strong> 95%+ operations complete successfully
                            </div>
                        </div>

                        <!-- WebRTC Call Center -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-lime-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-lime-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">WebRTC Call Center</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì JsSIP v3.10.1 browser softphone</li>
                                <li>‚úì WebSocket Secure (WSS) on port 7443</li>
                                <li>‚úì Agent dashboard with SIP registration</li>
                                <li>‚úì Call control (answer, hold, transfer, hangup)</li>
                                <li>‚úì Google Cloud firewall configured</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Platform:</strong> FusionPBX 34.26.59.14 (GCP VM)
                            </div>
                        </div>

                        <!-- Error Recovery -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-purple-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Automatic Error Recovery</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Thread reset with timestamped IDs</li>
                                <li>‚úì BrokenResourceError handling</li>
                                <li>‚úì tool_call_id incomplete error recovery</li>
                                <li>‚úì In-memory reset tracking (_reset_threads)</li>
                                <li>‚úì No cascading failures</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Benefit:</strong> Self-healing conversation threads
                            </div>
                        </div>

                        <!-- Performance Tracking -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-amber-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Performance Optimization</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Removed Google Calendar sync delay</li>
                                <li>‚úì Simplified JSON responses (no MCP breaks)</li>
                                <li>‚úì Agent processing time measurement</li>
                                <li>‚úì Transaction tracking per voice call</li>
                                <li>‚úì Custom Sentry metrics & measurements</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Result:</strong> Sub-5s response times
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-white p-4 rounded text-center">
                            <div class="text-2xl font-bold text-teal-600">2001</div>
                            <div class="text-xs text-gray-600">FusionPBX Extension</div>
                        </div>
                        <div class="bg-white p-4 rounded text-center">
                            <div class="text-2xl font-bold text-purple-600">Deepgram</div>
                            <div class="text-xs text-gray-600">STT API</div>
                        </div>
                        <div class="bg-white p-4 rounded text-center">
                            <div class="text-2xl font-bold text-purple-600">38</div>
                            <div class="text-xs text-gray-600">MCP Tools</div>
                        </div>
                        <div class="bg-white p-4 rounded text-center">
                            <div class="text-2xl font-bold text-green-600">12s</div>
                            <div class="text-xs text-gray-600">Max Response Time</div>
                        </div>
                        <div class="bg-white p-4 rounded text-center">
                            <div class="text-2xl font-bold text-rose-600">100%</div>
                            <div class="text-xs text-gray-600">Sentry Trace Rate</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WebRTC Voice Integration Architecture -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">WebRTC Voice Integration Architecture</h3>
                <div class="bg-gradient-to-r from-sky-50 to-blue-50 p-6 rounded-lg border-2 border-sky-200">
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">WebRTC Voice Assistant Architecture</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <!-- WebRTC Speech-to-Deepgram Flow Diagram -->
                            <div class="mb-8">
                                <h5 class="text-lg font-semibold mb-4 text-gray-800">WebRTC Speech-to-Deepgram Processing Flow</h5>
                                <div class="bg-gray-50 p-4 rounded-lg border">
                                    <div class="flex justify-center items-center space-x-4">
                                        <!-- Browser -->
                                        <div class="text-center">
                                            <div class="w-12 h-12 bg-blue-100 border-2 border-blue-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                                <span class="text-blue-800 font-bold text-xs">üåê</span>
                                            </div>
                                            <div class="text-xs font-medium text-gray-800">Browser</div>
                                            <div class="text-xs text-gray-600">WebRTC</div>
                                        </div>
                                        
                                        <!-- Arrow -->
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                            </svg>
                                        </div>
                                        
                                        <!-- Socket.IO -->
                                        <div class="text-center">
                                            <div class="w-12 h-12 bg-green-100 border-2 border-green-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                                <span class="text-green-800 font-bold text-xs">üì°</span>
                                            </div>
                                            <div class="text-xs font-medium text-gray-800">Socket.IO</div>
                                            <div class="text-xs text-gray-600">WebSocket</div>
                                        </div>
                                        
                                        <!-- Arrow -->
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                            </svg>
                                        </div>
                                        
                                        <!-- Redis Buffer -->
                                        <div class="text-center">
                                            <div class="w-12 h-12 bg-amber-100 border-2 border-amber-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                                <span class="text-amber-800 font-bold text-xs">üíæ</span>
                                            </div>
                                            <div class="text-xs font-medium text-gray-800">Redis</div>
                                            <div class="text-xs text-gray-600">Buffer</div>
                                        </div>
                                        
                                        <!-- Arrow -->
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                            </svg>
                                        </div>
                                        
                                        <!-- Deepgram -->
                                        <div class="text-center">
                                            <div class="w-12 h-12 bg-purple-100 border-2 border-purple-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                                <span class="text-purple-800 font-bold text-xs">üéß</span>
                                            </div>
                                            <div class="text-xs font-medium text-gray-800">Deepgram</div>
                                            <div class="text-xs text-gray-600">STT API</div>
                                        </div>
                                        
                                        <!-- Arrow -->
                                        <div class="flex items-center">
                                            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                            </svg>
                                        </div>
                                        
                                        <!-- LangGraph -->
                                        <div class="text-center">
                                            <div class="w-12 h-12 bg-indigo-100 border-2 border-indigo-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                                <span class="text-indigo-800 font-bold text-xs">üß†</span>
                                            </div>
                                            <div class="text-xs font-medium text-gray-800">LangGraph</div>
                                            <div class="text-xs text-gray-600">AI Agent</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Flow Description -->
                                    <div class="mt-4 text-center">
                                        <p class="text-xs text-gray-600">
                                            <strong>Corrected Flow:</strong> User Browser ‚Üí PIN Auth (PostgreSQL) ‚Üí WebRTC Audio Capture ‚Üí Socket.IO Streaming ‚Üí Redis Audio Buffer ‚Üí Deepgram STT ‚Üí LangGraph ‚Üí Claude LLM ‚Üí Tool Calling (PostgreSQL/Google APIs) ‚Üí Deepgram TTS ‚Üí Redis Buffer ‚Üí Socket.IO ‚Üí User Browser
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Flow Phases Summary -->
                            <div class="mt-6 bg-white p-6 rounded-lg border-2 border-gray-200">
                                <div class="flex items-center justify-between mb-4">
                                    <h5 class="text-lg font-semibold text-gray-800">WebRTC Voice Assistant Flow Phases</h5>
                                    <a href="{{ url_for('convonet_sequence_diagram') }}" 
                                       class="text-sm text-blue-600 hover:text-blue-800 underline font-medium">
                                        View Detailed Sequence Diagram ‚Üí
                                    </a>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <!-- Phase 1: Authentication -->
                                    <div class="border-l-4 border-blue-500 pl-4">
                                        <h6 class="font-semibold text-gray-800 mb-1">Phase 1: Authentication</h6>
                                        <p class="text-xs text-gray-600 mb-2">Steps 1-7</p>
                                        <p class="text-sm text-gray-600">WebSocket connection, PIN authentication via PostgreSQL, Redis session creation</p>
                                    </div>
                                    
                                    <!-- Phase 2: Normal Conversation Loop -->
                                    <div class="border-l-4 border-green-500 pl-4">
                                        <h6 class="font-semibold text-gray-800 mb-1">Phase 2: Conversation Loop</h6>
                                        <p class="text-xs text-gray-600 mb-2">Steps 8-31</p>
                                        <p class="text-sm text-gray-600">Audio capture ‚Üí Redis buffer ‚Üí Deepgram STT ‚Üí LangGraph ‚Üí Claude LLM ‚Üí Tool execution ‚Üí Deepgram TTS ‚Üí Response</p>
                                    </div>
                                    
                                    <!-- Phase 3: Transfer Request -->
                                    <div class="border-l-4 border-yellow-500 pl-4">
                                        <h6 class="font-semibold text-gray-800 mb-1">Phase 3: Transfer Request</h6>
                                        <p class="text-xs text-gray-600 mb-2">Steps 32-38</p>
                                        <p class="text-sm text-gray-600">User requests transfer, LangGraph detects intent, sets transfer flag in Redis</p>
                                    </div>
                                    
                                    <!-- Phase 4: Twilio Transfer -->
                                    <div class="border-l-4 border-pink-500 pl-4">
                                        <h6 class="font-semibold text-gray-800 mb-1">Phase 4: Twilio Transfer</h6>
                                        <p class="text-xs text-gray-600 mb-2">Steps 39-52</p>
                                        <p class="text-sm text-gray-600">Twilio API ‚Üí FusionPBX ‚Üí Agent Dashboard (JsSIP) ‚Üí Live conversation bridging</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>WebRTC Architecture:</strong> Browser-based voice assistant with PostgreSQL PIN authentication, Redis session and audio buffer management, 
                                    real-time audio streaming via Socket.IO, Deepgram STT transcription (not Twilio), LangGraph AI orchestration with Claude LLM and Deepgram TTS, 
                                    MCP tool integration (PostgreSQL, Google APIs), and seamless transfer to FusionPBX call center via Twilio SIP trunking.
                                </p>
                            </div>
                            
                            <!-- Component Interaction Matrix -->
                            <div class="mt-8 bg-white p-6 rounded-lg border-2 border-gray-200">
                                <h5 class="text-lg font-semibold mb-4 text-gray-800">Component Interaction Matrix</h5>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 text-sm">
                                        <thead class="bg-gray-50">
                                            <tr>
                                                <th class="px-4 py-3 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">Component</th>
                                                <th class="px-4 py-3 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">Input From</th>
                                                <th class="px-4 py-3 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">Output To</th>
                                                <th class="px-4 py-3 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">Purpose</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-gray-200">
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">User Browser</td>
                                                <td class="px-4 py-3 text-gray-600">User voice input</td>
                                                <td class="px-4 py-3 text-gray-600">WebSocket Server</td>
                                                <td class="px-4 py-3 text-gray-600">Captures audio, displays UI</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">WebSocket Server</td>
                                                <td class="px-4 py-3 text-gray-600">Browser, WebRTC Server</td>
                                                <td class="px-4 py-3 text-gray-600">Browser, Redis</td>
                                                <td class="px-4 py-3 text-gray-600">Manages real-time communication</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">PIN Auth</td>
                                                <td class="px-4 py-3 text-gray-600">WebSocket Server</td>
                                                <td class="px-4 py-3 text-gray-600">PostgreSQL</td>
                                                <td class="px-4 py-3 text-gray-600">Validates user credentials</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">Redis</td>
                                                <td class="px-4 py-3 text-gray-600">WebRTC Server, Tools</td>
                                                <td class="px-4 py-3 text-gray-600">Deepgram, WebRTC Server</td>
                                                <td class="px-4 py-3 text-gray-600">Buffers audio, stores session</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">Deepgram STT</td>
                                                <td class="px-4 py-3 text-gray-600">Redis Audio Buffer</td>
                                                <td class="px-4 py-3 text-gray-600">WebRTC Voice Server</td>
                                                <td class="px-4 py-3 text-gray-600">Converts speech to text</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">LangGraph</td>
                                                <td class="px-4 py-3 text-gray-600">WebRTC Server</td>
                                                <td class="px-4 py-3 text-gray-600">Claude LLM, Tools</td>
                                                <td class="px-4 py-3 text-gray-600">Orchestrates AI conversation flow</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">Claude LLM</td>
                                                <td class="px-4 py-3 text-gray-600">LangGraph</td>
                                                <td class="px-4 py-3 text-gray-600">LangGraph</td>
                                                <td class="px-4 py-3 text-gray-600">Generates responses, decides actions</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">Tool Calling</td>
                                                <td class="px-4 py-3 text-gray-600">LangGraph</td>
                                                <td class="px-4 py-3 text-gray-600">PostgreSQL, Google APIs</td>
                                                <td class="px-4 py-3 text-gray-600">Executes external operations</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">Deepgram TTS</td>
                                                <td class="px-4 py-3 text-gray-600">LangGraph Response</td>
                                                <td class="px-4 py-3 text-gray-600">WebRTC Server</td>
                                                <td class="px-4 py-3 text-gray-600">Converts text to speech</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">Twilio API</td>
                                                <td class="px-4 py-3 text-gray-600">WebRTC Server</td>
                                                <td class="px-4 py-3 text-gray-600">FusionPBX</td>
                                                <td class="px-4 py-3 text-gray-600">Bridges call to agent</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-3 font-medium text-gray-800">FusionPBX</td>
                                                <td class="px-4 py-3 text-gray-600">Twilio</td>
                                                <td class="px-4 py-3 text-gray-600">Agent Dashboard</td>
                                                <td class="px-4 py-3 text-gray-600">Routes call to extension</td>
                                            </tr>
                                            <tr class="bg-gray-50">
                                                <td class="px-4 py-3 font-medium text-gray-800">Agent Dashboard</td>
                                                <td class="px-4 py-3 text-gray-600">FusionPBX</td>
                                                <td class="px-4 py-3 text-gray-600">PostgreSQL, User</td>
                                                <td class="px-4 py-3 text-gray-600">Displays call, shows user info</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- WebRTC Voice Interface -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-sky-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-sky-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">WebRTC Voice Interface</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Browser-based voice recording</li>
                                <li>‚úì Real-time audio streaming</li>
                                <li>‚úì WebSocket communication</li>
                                <li>‚úì Audio format detection (WebM)</li>
                                <li>‚úì Base64 audio encoding</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Technology:</strong> WebRTC + Socket.IO
                            </div>
                        </div>

                        <!-- Redis Session Management -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-amber-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Redis Session Management</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Session storage & caching</li>
                                <li>‚úì Audio buffer management</li>
                                <li>‚úì Real-time notifications</li>
                                <li>‚úì User activity tracking</li>
                                <li>‚úì Session expiration handling</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Integration:</strong> Redis Pub/Sub + Session Store
                            </div>
                        </div>

                        <!-- Composio Tool Integration -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-violet-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Composio Integration</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Slack workspace integration</li>
                                <li>‚úì GitHub repository management</li>
                                <li>‚úì Gmail email automation</li>
                                <li>‚úì Notion workspace sync</li>
                                <li>‚úì Jira project management</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Platforms:</strong> Slack, GitHub, Gmail, Notion, Jira
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Features: Redis, Composio, Audio Stream Player -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Latest Features (October 2025)</h3>
                <div class="bg-gradient-to-r from-amber-50 to-violet-50 p-6 rounded-lg border-2 border-amber-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Redis Integration -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-amber-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Redis Session Management</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Session storage & caching</li>
                                <li>‚úì Audio buffer management</li>
                                <li>‚úì Real-time notifications (Pub/Sub)</li>
                                <li>‚úì Rate limiting & analytics</li>
                                <li>‚úì User activity tracking</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Files:</strong> redis_manager.py, REDIS_DATA_GUIDE.md
                            </div>
                        </div>

                        <!-- Composio Integration -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-violet-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Composio Tool Integration</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Slack workspace integration</li>
                                <li>‚úì GitHub repository management</li>
                                <li>‚úì Gmail email automation</li>
                                <li>‚úì Notion workspace sync</li>
                                <li>‚úì Jira project management</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Integration:</strong> External tool orchestration
                            </div>
                        </div>

                        <!-- Audio Stream Player -->
                        <div class="bg-white p-5 rounded-lg shadow-sm">
                            <div class="flex items-center mb-3">
                                <span class="bg-emerald-100 p-2 rounded-full mr-3">
                                    <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                                    </svg>
                                </span>
                                <h4 class="text-lg font-semibold text-gray-800">Audio Stream Player</h4>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-1.5">
                                <li>‚úì Redis audio buffer playback</li>
                                <li>‚úì WebM format support</li>
                                <li>‚úì Real-time audio streaming</li>
                                <li>‚úì Session audio download</li>
                                <li>‚úì Audio format detection</li>
                            </ul>
                            <div class="mt-3 text-xs text-gray-500">
                                <strong>Files:</strong> audio_player_routes.py, audio_stream_player.py
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module Structure -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Module Structure</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="flex justify-center">
                        <div class="bg-white p-4 rounded border max-w-3xl w-full">
                            <h4 class="font-semibold text-gray-800 mb-3">Convonet Project Structure</h4>
                            <div class="font-mono text-sm overflow-x-auto">
                                <pre>Project Root/
‚îú‚îÄ‚îÄ app.py                          # Main Flask application
‚îú‚îÄ‚îÄ app_memory_optimized.py         # Memory-optimized Flask application
‚îú‚îÄ‚îÄ passenger_wsgi.py               # WSGI entry point for main app
‚îú‚îÄ‚îÄ passenger_wsgi_memory_optimized.py  # WSGI entry for memory-optimized app
‚îú‚îÄ‚îÄ extensions.py                   # Flask extensions (db, login, migrate, etc.)
‚îú‚îÄ‚îÄ requirements.txt                # Python dependencies
‚îú‚îÄ‚îÄ requirements_memory_optimized.txt  # Memory-optimized dependencies
‚îú‚îÄ‚îÄ Procfile                        # Render.com process file
‚îú‚îÄ‚îÄ render.yaml                     # Render.com deployment config
‚îú‚îÄ‚îÄ render_memory_optimized.yaml    # Memory-optimized deployment config
‚îú‚îÄ‚îÄ render-build.sh                 # Build script for Render.com
‚îú‚îÄ‚îÄ deepgram_service.py             # Deepgram STT service (root level)
‚îú‚îÄ‚îÄ deepgram_webrtc_integration.py  # WebRTC Deepgram integration (root level)
‚îú‚îÄ‚îÄ templates/                      # Flask templates
‚îÇ   ‚îú‚îÄ‚îÄ team_dashboard.html         # Team management UI
‚îÇ   ‚îú‚îÄ‚îÄ register.html               # User registration
‚îÇ   ‚îú‚îÄ‚îÄ convonet_tech_spec.html     # Technical documentation
‚îÇ   ‚îú‚îÄ‚îÄ convonet_system_architecture.html  # System architecture diagram
‚îÇ   ‚îî‚îÄ‚îÄ convonet_sequence_diagram.html     # Sequence diagram page
‚îú‚îÄ‚îÄ static/                         # Static assets
‚îÇ   ‚îî‚îÄ‚îÄ convonet/                   # Convonet static files
‚îÇ       ‚îî‚îÄ‚îÄ assets/                 # Images, CSS, JS
‚îú‚îÄ‚îÄ shared/                         # Shared utilities
‚îÇ   ‚îú‚îÄ‚îÄ google_calendar.py          # Google Calendar integration
‚îÇ   ‚îú‚îÄ‚îÄ helpers.py                  # Shared helper functions
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py                  # Shared data schemas
‚îî‚îÄ‚îÄ convonet/                       # Convonet module
    ‚îú‚îÄ‚îÄ __init__.py                 # Package initialization
    ‚îú‚îÄ‚îÄ routes.py                   # Flask routes & Twilio webhooks (Sentry integrated)
    ‚îú‚îÄ‚îÄ assistant_graph_todo.py     # LangGraph agent (optimized timeouts)
    ‚îú‚îÄ‚îÄ state.py                    # Agent state management
    ‚îú‚îÄ‚îÄ webrtc_voice_server.py      # WebRTC voice assistant server
    ‚îú‚îÄ‚îÄ audio_player_routes.py      # Audio stream player routes
    ‚îú‚îÄ‚îÄ redis_manager.py            # Redis session & audio buffer management
    ‚îú‚îÄ‚îÄ composio_tools.py           # Composio tool integration
    ‚îú‚îÄ‚îÄ twilio_handler.py           # Twilio call handling
    ‚îú‚îÄ‚îÄ voice_intent_utils.py       # Voice intent detection utilities
    ‚îú‚îÄ‚îÄ voice_utils.py              # Voice processing utilities
    ‚îú‚îÄ‚îÄ environment_config.py       # Environment configuration
    ‚îú‚îÄ‚îÄ models/                     # Database models
    ‚îÇ   ‚îú‚îÄ‚îÄ base.py                 # Shared SQLAlchemy Base
    ‚îÇ   ‚îî‚îÄ‚îÄ user_models.py          # User, Team, TeamMembership models
    ‚îú‚îÄ‚îÄ security/                   # Authentication & authorization
    ‚îÇ   ‚îî‚îÄ‚îÄ auth.py                 # JWT authentication system
    ‚îú‚îÄ‚îÄ api_routes/                 # RESTful API endpoints
    ‚îÇ   ‚îú‚îÄ‚îÄ auth_routes.py          # User registration & login
    ‚îÇ   ‚îú‚îÄ‚îÄ jwt_scr.py              # JWT secret key management
    ‚îÇ   ‚îú‚îÄ‚îÄ team_routes.py          # Team management API
    ‚îÇ   ‚îî‚îÄ‚îÄ team_todo_routes.py     # Team todo management API
    ‚îú‚îÄ‚îÄ migrations/                 # Database migrations
    ‚îÇ   ‚îú‚îÄ‚îÄ add_team_collaboration.py  # Team collaboration migration
    ‚îÇ   ‚îî‚îÄ‚îÄ add_voice_pin.py        # Voice PIN authentication migration
    ‚îú‚îÄ‚îÄ mcps/                       # Model Context Protocol servers
    ‚îÇ   ‚îú‚îÄ‚îÄ mcp_config.json         # MCP server configuration
    ‚îÇ   ‚îî‚îÄ‚îÄ local_servers/
    ‚îÇ       ‚îú‚îÄ‚îÄ db_todo.py          # 36 database tools (optimized)
    ‚îÇ       ‚îú‚îÄ‚îÄ call_transfer.py    # 2 call transfer tools (FusionPBX)
    ‚îÇ       ‚îî‚îÄ‚îÄ google_calendar.py  # Calendar operations
    ‚îú‚îÄ‚îÄ static/                     # Convonet static assets
    ‚îÇ   ‚îî‚îÄ‚îÄ assets/
    ‚îÇ       ‚îú‚îÄ‚îÄ img/                # Images & diagrams
    ‚îÇ       ‚îú‚îÄ‚îÄ css/                # Stylesheets
    ‚îÇ       ‚îî‚îÄ‚îÄ js/                 # JavaScript files
    ‚îî‚îÄ‚îÄ templates/                  # Convonet templates
        ‚îú‚îÄ‚îÄ convonet_todo_index.html  # Main todo interface
        ‚îî‚îÄ‚îÄ webrtc_voice_assistant.html  # WebRTC voice assistant UI</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Database Schema -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Database Schema</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- Users Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">users_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ email: String (unique)</li>
                                <li>‚Ä¢ username: String (unique)</li>
                                <li>‚Ä¢ password_hash: String</li>
                                <li>‚Ä¢ first_name: String</li>
                                <li>‚Ä¢ last_name: String</li>
                                <li>‚Ä¢ is_active: Boolean</li>
                                <li>‚Ä¢ is_verified: Boolean</li>
                                <li>‚Ä¢ created_at: DateTime</li>
                                <li>‚Ä¢ last_login_at: DateTime</li>
                            </ul>
                        </div>
                        
                        <!-- Teams Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">teams_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ name: String</li>
                                <li>‚Ä¢ description: Text</li>
                                <li>‚Ä¢ is_active: Boolean</li>
                                <li>‚Ä¢ created_at: DateTime</li>
                                <li>‚Ä¢ updated_at: DateTime</li>
                            </ul>
                        </div>
                        
                        <!-- Team Memberships Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">team_memberships_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ team_id: UUID (FK)</li>
                                <li>‚Ä¢ user_id: UUID (FK)</li>
                                <li>‚Ä¢ role: Enum (owner/admin/member/viewer)</li>
                                <li>‚Ä¢ joined_at: DateTime</li>
                                <li>‚Ä¢ updated_at: DateTime</li>
                            </ul>
                        </div>
                        
                        <!-- Todos Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">todos_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ title: String</li>
                                <li>‚Ä¢ description: String</li>
                                <li>‚Ä¢ completed: Boolean</li>
                                <li>‚Ä¢ priority: Enum</li>
                                <li>‚Ä¢ due_date: DateTime</li>
                                <li>‚Ä¢ creator_id: UUID (FK)</li>
                                <li>‚Ä¢ assignee_id: UUID (FK)</li>
                                <li>‚Ä¢ team_id: UUID (FK)</li>
                                <li>‚Ä¢ is_private: Boolean</li>
                                <li>‚Ä¢ google_calendar_event_id</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                        <!-- Reminders Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">reminders_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ reminder_text: String</li>
                                <li>‚Ä¢ importance: Enum</li>
                                <li>‚Ä¢ reminder_date: DateTime</li>
                                <li>‚Ä¢ google_calendar_event_id</li>
                                <li>‚Ä¢ created_at: DateTime</li>
                                <li>‚Ä¢ updated_at: DateTime</li>
                            </ul>
                        </div>
                        
                        <!-- Calendar Events Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">calendar_events_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ title: String</li>
                                <li>‚Ä¢ description: String</li>
                                <li>‚Ä¢ event_from: DateTime</li>
                                <li>‚Ä¢ event_to: DateTime</li>
                                <li>‚Ä¢ google_calendar_event_id</li>
                                <li>‚Ä¢ created_at: DateTime</li>
                                <li>‚Ä¢ updated_at: DateTime</li>
                            </ul>
                        </div>
                        
                        <!-- Call Recordings Table -->
                        <div class="bg-white p-6 rounded-lg shadow">
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">call_recordings_anthropic</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ id: UUID (PK)</li>
                                <li>‚Ä¢ call_sid: String (unique)</li>
                                <li>‚Ä¢ from_number: String</li>
                                <li>‚Ä¢ to_number: String</li>
                                <li>‚Ä¢ recording_path: String</li>
                                <li>‚Ä¢ transcription: Text</li>
                                <li>‚Ä¢ status: String</li>
                                <li>‚Ä¢ created_at: DateTime</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Team Collaboration Architecture -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Team Collaboration Architecture</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Team Relationship Diagram</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="font-mono text-sm overflow-x-auto">
                                <pre>
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  User           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id (UUID) PK    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ email (unique)  ‚îÇ      ‚îÇ
‚îÇ username        ‚îÇ      ‚îÇ
‚îÇ password_hash   ‚îÇ      ‚îÇ
‚îÇ first_name      ‚îÇ      ‚îÇ
‚îÇ last_name       ‚îÇ      ‚îÇ
‚îÇ is_active       ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
         ‚îÇ               ‚îÇ
         ‚îÇ user_id (FK)  ‚îÇ
         ‚ñº               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ TeamMembership  ‚îÇ      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îÇ
‚îÇ id (UUID) PK    ‚îÇ      ‚îÇ
‚îÇ team_id (FK)‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ user_id (FK)‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ role (ENUM)     ‚îÇ      ‚îÇ
‚îÇ joined_at       ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
         ‚îÇ               ‚îÇ
         ‚îÇ team_id (FK)  ‚îÇ
         ‚ñº               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  Team           ‚îÇ      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îÇ
‚îÇ id (UUID) PK    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ name            ‚îÇ      ‚îÇ
‚îÇ description     ‚îÇ      ‚îÇ
‚îÇ is_active       ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
         ‚îÇ               ‚îÇ
         ‚îÇ team_id (FK)  ‚îÇ
         ‚ñº               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  Todo           ‚îÇ      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§      ‚îÇ
‚îÇ id (UUID) PK    ‚îÇ      ‚îÇ
‚îÇ title           ‚îÇ      ‚îÇ
‚îÇ priority        ‚îÇ      ‚îÇ
‚îÇ creator_id (FK)‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ assignee_id(FK)‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ team_id (FK)‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ is_private      ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ google_cal_id   ‚îÇ  ‚îÇ   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ   ‚îÇ
                     ‚îÇ   ‚îÇ
                     ‚ñº   ‚ñº
              Team & User References
</pre>
                            </div>
                            <div class="mt-4 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>Relationships:</strong> Users belong to Teams via TeamMembership. Todos can be assigned to Teams and Users with role-based permissions.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Team Roles</h4>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li>‚Ä¢ <strong>OWNER:</strong> Full control, can delete team</li>
                                <li>‚Ä¢ <strong>ADMIN:</strong> Manage members and todos</li>
                                <li>‚Ä¢ <strong>MEMBER:</strong> Create and edit own todos</li>
                                <li>‚Ä¢ <strong>VIEWER:</strong> Read-only access</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Access Control</h4>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li>‚Ä¢ JWT token-based authentication</li>
                                <li>‚Ä¢ 30-minute access token expiry</li>
                                <li>‚Ä¢ 7-day refresh token validity</li>
                                <li>‚Ä¢ Role-based authorization checks</li>
                                <li>‚Ä¢ Team membership validation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LangGraph Architecture -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">LangGraph Agent Architecture</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <!-- LangGraph Workflow Diagram -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">LangGraph Workflow Diagram</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="flex justify-center">
                                <img src="/anthropic/convonet_todo/static/assets/img/lgwfdg.png" 
                                     alt="LangGraph Workflow Diagram" 
                                     class="max-w-full h-auto rounded-lg shadow-lg"
                                     style="max-width: 800px; height: auto;">
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>LangGraph Workflow:</strong> The agent can either continue to use tools or end the conversation based on user input and context.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-3">Agent Components</h4>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li>‚Ä¢ <strong>TodoAgent Class:</strong> Main agent orchestrator with lazy initialization</li>
                                <li>‚Ä¢ <strong>StateGraph:</strong> Manages conversation flow and state</li>
                                <li>‚Ä¢ <strong>Assistant Node:</strong> GPT-4 reasoning and response generation</li>
                                <li>‚Ä¢ <strong>Tool Node:</strong> Executes 38 MCP tools</li>
                                <li>‚Ä¢ <strong>Conditional Edges:</strong> Routes between nodes based on tool calls</li>
                                <li>‚Ä¢ <strong>InMemorySaver:</strong> Checkpointer for state persistence</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-3">State Management</h4>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li>‚Ä¢ <strong>AgentState:</strong> Conversation state with message history</li>
                                <li>‚Ä¢ <strong>Message History:</strong> Maintains context across turns</li>
                                <li>‚Ä¢ <strong>Customer ID:</strong> User identification for multi-tenant</li>
                                <li>‚Ä¢ <strong>Thread ID:</strong> Conversation thread tracking</li>
                                <li>‚Ä¢ <strong>Lazy Loading:</strong> Prevents circular imports</li>
                                <li>‚Ä¢ <strong>ExceptionGroup Handling:</strong> Robust error recovery</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MCP Integration -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Model Context Protocol (MCP) Integration</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        MCP provides a standardized way for AI agents to interact with external tools and services. 
                        The Convonet system uses MCP to expose 38 tools for database operations, team management, 
                        call transfer to FusionPBX, Google Calendar integration, and WebRTC voice processing with Deepgram STT.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">MCP Server Configuration</h4>
                            <div class="font-mono text-sm bg-gray-100 p-3 rounded">
                                <pre>{
  "mcpServers": {
    "db": {
      "command": "python",
      "args": ["./convonet/mcps/local_servers/db_todo.py"],
      "transport": "stdio",
      "env": {
        "DB_URI": "${DB_URI}",
        "GOOGLE_OAUTH2_TOKEN_B64": "${GOOGLE_OAUTH2_TOKEN_B64}",
        "GOOGLE_CLIENT_ID": "${GOOGLE_CLIENT_ID}",
        "GOOGLE_CLIENT_SECRET": "${GOOGLE_CLIENT_SECRET}"
      }
    }
  }
}</pre>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Available MCP Tools (38)</h4>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <h5 class="font-semibold text-xs text-gray-700 mb-1">Todo Management (5)</h5>
                                    <ul class="text-xs text-gray-600 space-y-1">
                                        <li>‚Ä¢ create_todo</li>
                                        <li>‚Ä¢ get_todos</li>
                                        <li>‚Ä¢ complete_todo</li>
                                        <li>‚Ä¢ update_todo</li>
                                        <li>‚Ä¢ delete_todo</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-xs text-gray-700 mb-1">Team Tools (8)</h5>
                                    <ul class="text-xs text-gray-600 space-y-1">
                                        <li>‚Ä¢ create_team</li>
                                        <li>‚Ä¢ get_teams</li>
                                        <li>‚Ä¢ get_team_members</li>
                                        <li>‚Ä¢ create_team_todo</li>
                                        <li>‚Ä¢ add_team_member</li>
                                        <li>‚Ä¢ remove_team_member</li>
                                        <li>‚Ä¢ change_member_role</li>
                                        <li>‚Ä¢ search_users</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-xs text-gray-700 mb-1">Reminders (4)</h5>
                                    <ul class="text-xs text-gray-600 space-y-1">
                                        <li>‚Ä¢ create_reminder</li>
                                        <li>‚Ä¢ get_reminders</li>
                                        <li>‚Ä¢ update_reminder</li>
                                        <li>‚Ä¢ delete_reminder</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-xs text-gray-700 mb-1">Calendar (6)</h5>
                                    <ul class="text-xs text-gray-600 space-y-1">
                                        <li>‚Ä¢ create_calendar_event</li>
                                        <li>‚Ä¢ get_calendar_events</li>
                                        <li>‚Ä¢ update_calendar_event</li>
                                        <li>‚Ä¢ delete_calendar_event</li>
                                        <li>‚Ä¢ sync_google_calendar_events</li>
                                        <li>‚Ä¢ test_google_calendar</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-xs text-gray-700 mb-1">Call Transfer (2)</h5>
                                    <ul class="text-xs text-gray-600 space-y-1">
                                        <li>‚Ä¢ transfer_to_agent</li>
                                        <li>‚Ä¢ get_available_departments</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced LangGraph Tool Calls -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Enhanced LangGraph Tool Calls</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The LangGraph implementation provides intelligent tool calling capabilities with dynamic tool selection 
                        and error handling. The agent automatically chooses appropriate tools based on user intent and maintains 
                        conversation context for seamless interactions.
                    </p>
                    
                    <!-- Tool Calls Flow Diagram -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Tool Calls Flow Diagram</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="flex justify-center">
                                <img src="/anthropic/convonet_todo/static/assets/img/tool_calls_flow_diagram.png" 
                                     alt="Tool Calls Flow Diagram" 
                                     class="max-w-full h-auto rounded-lg shadow-lg"
                                     style="max-width: 900px; height: auto;">
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>Tool Calls Flow:</strong> LangGraph implementation showing dynamic tool selection and intelligent orchestration of MCP tools.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tool Calls Features -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Tool Calls Features</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-gray-50 p-4 rounded border">
                                    <h5 class="font-semibold text-gray-800 mb-2">MCP Integration</h5>
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>‚Ä¢ Database operations via MCP servers</li>
                                        <li>‚Ä¢ Google Calendar synchronization</li>
                                        <li>‚Ä¢ Team collaboration tools</li>
                                        <li>‚Ä¢ Real-time tool discovery (38 tools)</li>
                                        <li>‚Ä¢ Secure tool communication via stdio</li>
                                        <li>‚Ä¢ Lazy loading for performance</li>
                                    </ul>
                                </div>
                                <div class="bg-gray-50 p-4 rounded border">
                                    <h5 class="font-semibold text-gray-800 mb-2">Error Handling</h5>
                                    <ul class="text-sm text-gray-600 space-y-1">
                                        <li>‚Ä¢ Graceful tool failure recovery</li>
                                        <li>‚Ä¢ ExceptionGroup unwrapping</li>
                                        <li>‚Ä¢ 20s timeout per tool</li>
                                        <li>‚Ä¢ 30s overall agent timeout</li>
                                        <li>‚Ä¢ Fallback strategies</li>
                                        <li>‚Ä¢ User-friendly error messages</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>Tool Features:</strong> Intelligent tool calling system with error recovery, timeout management, and seamless MCP integration.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">Core Tool Calling Capabilities</h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>‚Ä¢ <strong>Dynamic Tool Selection:</strong> LLM intelligently chooses appropriate tools based on user intent</li>
                            <li>‚Ä¢ <strong>Error Recovery:</strong> Graceful handling of tool failures with fallback strategies</li>
                            <li>‚Ä¢ <strong>Context Awareness:</strong> Tools access conversation history and maintain state</li>
                            <li>‚Ä¢ <strong>Streaming Responses:</strong> Real-time tool execution updates for better user experience</li>
                            <li>‚Ä¢ <strong>Async Execution:</strong> Non-blocking tool calls with proper timeout management</li>
                            <li>‚Ä¢ <strong>ExceptionGroup Handling:</strong> Unwraps and logs complex async exceptions</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Authentication System -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">JWT Authentication System</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-3">Authentication Flow</h4>
                            <div class="space-y-3">
                                <div class="bg-blue-50 p-3 rounded">
                                    <div class="font-semibold text-sm text-blue-800">1. User Registration</div>
                                    <div class="text-xs text-blue-600">POST /api/auth/register ‚Üí Bcrypt hash ‚Üí JWT tokens</div>
                                </div>
                                <div class="bg-green-50 p-3 rounded">
                                    <div class="font-semibold text-sm text-green-800">2. User Login</div>
                                    <div class="text-xs text-green-600">POST /api/auth/login ‚Üí Verify password ‚Üí Generate tokens</div>
                                </div>
                                <div class="bg-purple-50 p-3 rounded">
                                    <div class="font-semibold text-sm text-purple-800">3. API Request</div>
                                    <div class="text-xs text-purple-600">Bearer token ‚Üí JWT validation ‚Üí @require_auth</div>
                                </div>
                                <div class="bg-orange-50 p-3 rounded">
                                    <div class="font-semibold text-sm text-orange-800">4. Token Refresh</div>
                                    <div class="text-xs text-orange-600">POST /api/auth/refresh ‚Üí New access token</div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-3">Security Features</h4>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li>‚Ä¢ <strong>Password Hashing:</strong> Bcrypt with automatic salt</li>
                                <li>‚Ä¢ <strong>JWT Tokens:</strong> HS256 algorithm with secret key</li>
                                <li>‚Ä¢ <strong>Token Expiry:</strong> 30 min access, 7 day refresh</li>
                                <li>‚Ä¢ <strong>Authorization:</strong> @require_auth decorator</li>
                                <li>‚Ä¢ <strong>Role Validation:</strong> @require_role decorator</li>
                                <li>‚Ä¢ <strong>Team Membership:</strong> @require_team_member decorator</li>
                                <li>‚Ä¢ <strong>Auto Logout:</strong> Frontend handles expired tokens</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-6 bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">JWT Token Structure</h4>
                        <div class="font-mono text-sm bg-gray-100 p-3 rounded">
                            <pre>{
  "user_id": "uuid",
  "email": "user@example.com",
  "roles": ["user"],
  "team_id": "uuid",
  "type": "access",
  "exp": 1728589200,  // 30 minutes from issue
  "iat": 1728587400   // issued at timestamp
}</pre>
                        </div>
                    </div>
                </div>
            </div>


            <!-- New Features Technical Details -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">New Features Technical Details</h3>
                <div class="space-y-8">
                    
                    <!-- Redis Integration Details -->
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-6 rounded-lg border-2 border-amber-200">
                        <h4 class="text-xl font-semibold mb-4 text-gray-800 flex items-center">
                            <span class="bg-amber-100 p-2 rounded-full mr-3">
                                <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                                </svg>
                            </span>
                            Redis Session Management & Caching
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Session Management</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ Session creation, retrieval, updates, deletion</li>
                                    <li>‚Ä¢ Audio buffer storage (base64 encoded)</li>
                                    <li>‚Ä¢ User authentication state management</li>
                                    <li>‚Ä¢ Session expiration handling</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Real-time Features</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ Pub/Sub notifications for team updates</li>
                                    <li>‚Ä¢ Rate limiting (requests per minute)</li>
                                    <li>‚Ä¢ User activity tracking & analytics</li>
                                    <li>‚Ä¢ Cache invalidation strategies</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-gray-100 rounded">
                            <code class="text-sm text-gray-700">
                                # Redis connection with environment config<br>
                                REDIS_URL = os.getenv('REDIS_URL', 'redis://localhost:6379')<br>
                                # Session data structure<br>
                                session_data = {<br>
                                &nbsp;&nbsp;'user_id': 'user-123', 'audio_buffer': 'base64...',<br>
                                &nbsp;&nbsp;'created_at': timestamp, 'expires_at': ttl<br>
                                }
                            </code>
                        </div>
                    </div>

                    <!-- Composio Integration Details -->
                    <div class="bg-gradient-to-r from-violet-50 to-purple-50 p-6 rounded-lg border-2 border-violet-200">
                        <h4 class="text-xl font-semibold mb-4 text-gray-800 flex items-center">
                            <span class="bg-violet-100 p-2 rounded-full mr-3">
                                <svg class="w-5 h-5 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </span>
                            Composio External Tool Integration
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Supported Platforms</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ <strong>Slack:</strong> Message sending, channel management</li>
                                    <li>‚Ä¢ <strong>GitHub:</strong> Repository operations, issue tracking</li>
                                    <li>‚Ä¢ <strong>Gmail:</strong> Email composition, sending, management</li>
                                    <li>‚Ä¢ <strong>Notion:</strong> Page creation, database operations</li>
                                    <li>‚Ä¢ <strong>Jira:</strong> Ticket creation, project management</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Integration Features</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ OAuth2 authentication for each platform</li>
                                    <li>‚Ä¢ Robust method discovery for API compatibility</li>
                                    <li>‚Ä¢ Error handling for missing methods</li>
                                    <li>‚Ä¢ Tool orchestration with LangGraph</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-gray-100 rounded">
                            <code class="text-sm text-gray-700">
                                # Composio tool loading with fallback methods<br>
                                if hasattr(toolset, 'get_tools'):<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;tools = toolset.get_tools(apps=["slack"])<br>
                                elif hasattr(toolset, 'get_actions'):<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;tools = toolset.get_actions(apps=["slack"])
                            </code>
                        </div>
                    </div>

                    <!-- Audio Stream Player Details -->
                    <div class="bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-lg border-2 border-emerald-200">
                        <h4 class="text-xl font-semibold mb-4 text-gray-800 flex items-center">
                            <span class="bg-emerald-100 p-2 rounded-full mr-3">
                                <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                                </svg>
                            </span>
                            Audio Stream Player & WebM Support
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Audio Processing</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ WebM format detection & handling</li>
                                    <li>‚Ä¢ Base64 audio buffer decoding</li>
                                    <li>‚Ä¢ Real-time audio streaming from Redis</li>
                                    <li>‚Ä¢ Audio format conversion (WebM ‚Üí WAV fallback)</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Player Features</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>‚Ä¢ Session-based audio playback</li>
                                    <li>‚Ä¢ Audio file download (WebM/WAV)</li>
                                    <li>‚Ä¢ Audio buffer analysis & debugging</li>
                                    <li>‚Ä¢ Flask-SocketIO real-time updates</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-gray-100 rounded">
                            <code class="text-sm text-gray-700">
                                # WebM format detection<br>
                                if audio_data.startswith(b'\x1a\x45\xdf\xa3'):<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;return Response(audio_data, mimetype='audio/webm')<br>
                                # Audio buffer from Redis<br>
                                audio_buffer = session_data.get('audio_buffer', '')<br>
                                audio_data = base64.b64decode(audio_buffer)
                            </code>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API Endpoints -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">API Endpoints</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Authentication Endpoints -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Authentication</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/api/auth/register</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/api/auth/login</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/api/auth/refresh</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">GET /anthropic/api/auth/profile</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">PUT /anthropic/api/auth/profile</code></li>
                        </ul>
                    </div>
                    
                    <!-- Team Endpoints -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Team Management</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/api/teams/</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">GET /anthropic/api/teams/</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">GET /anthropic/api/teams/{id}</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/api/teams/{id}/members</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">DELETE /anthropic/api/teams/{id}/members/{user_id}</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">PUT /anthropic/api/teams/{id}/members/{user_id}/role</code></li>
                        </ul>
                    </div>
                    
                    <!-- Twilio Endpoints -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Twilio Voice</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/convonet_todo/twilio/call</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/convonet_todo/twilio/process_audio</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">POST /anthropic/convonet_todo/twilio/transfer</code></li>
                        </ul>
                        <div class="mt-3 p-3 bg-gray-50 rounded">
                            <p class="text-xs text-gray-600 mb-2">Webhook URL:</p>
                            <pre class="text-xs"><code>https://hjlees.com/anthropic/convonet_todo/twilio/call</code></pre>
                        </div>
                    </div>
                    
                    <!-- WebRTC Endpoints -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">WebRTC Voice</h4>
                        <ul class="text-sm text-gray-600 space-y-2">
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">GET /anthropic/webrtc/voice-assistant</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">WebSocket /voice</code></li>
                            <li><code class="bg-gray-100 px-2 py-1 rounded text-xs">GET /anthropic/audio-player/</code></li>
                        </ul>
                        <div class="mt-3 p-3 bg-gray-50 rounded">
                            <p class="text-xs text-gray-600 mb-2">WebRTC Voice Interface:</p>
                            <pre class="text-xs"><code>https://hjlees.com/anthropic/webrtc/voice-assistant</code></pre>
                        </div>
                        <div class="mt-2 p-3 bg-blue-50 rounded">
                            <p class="text-xs text-blue-800">
                                <strong>Features:</strong> Deepgram STT transcription, Redis audio buffer storage, Socket.IO real-time communication
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WebRTC Voice Interface -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">WebRTC Voice Interface</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The WebRTC Voice Interface provides browser-based voice interaction with real-time audio streaming, 
                        Redis session management, and seamless integration with the LangGraph AI agent. Users can interact 
                        with the assistant directly through their web browser without requiring phone calls.
                    </p>
                    
                    <!-- WebRTC Voice Interface Screenshot -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">WebRTC Voice Assistant Interface</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="flex justify-center">
                                <img src="/static/convonet/t_voice_i.png" 
                                     alt="WebRTC Voice Interface" 
                                     class="max-w-full h-auto rounded-lg shadow-lg"
                                     style="max-width: 800px; height: auto;">
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>WebRTC Interface:</strong> Browser-based voice assistant with real-time audio recording, session management, and AI-powered responses.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- WebRTC Processing Pipeline -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">WebRTC Audio Processing Pipeline</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-6 gap-4">
                                <!-- Browser Recording -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-sky-100 border-2 border-sky-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-sky-800 font-bold text-sm">üé§</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Browser Recording</div>
                                    <div class="text-xs text-gray-600">WebRTC API</div>
                                </div>
                                
                                <!-- WebSocket Stream -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-blue-100 border-2 border-blue-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-blue-800 font-bold text-sm">üì°</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">WebSocket Stream</div>
                                    <div class="text-xs text-gray-600">Socket.IO</div>
                                </div>
                                
                                <!-- Redis Buffer -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-amber-100 border-2 border-amber-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-amber-800 font-bold text-sm">üíæ</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Redis Buffer</div>
                                    <div class="text-xs text-gray-600">Session Storage</div>
                                </div>
                                
                                <!-- Deepgram STT -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-purple-100 border-2 border-purple-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-purple-800 font-bold text-sm">üéß</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Deepgram STT</div>
                                    <div class="text-xs text-gray-600">Transcription</div>
                                </div>
                                
                                <!-- LangGraph Agent -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-indigo-100 border-2 border-indigo-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-indigo-800 font-bold text-sm">üß†</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">LangGraph Agent</div>
                                    <div class="text-xs text-gray-600">AI Processing</div>
                                </div>
                                
                                <!-- TTS Response -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-orange-100 border-2 border-orange-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-orange-800 font-bold text-sm">üó£Ô∏è</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">TTS Response</div>
                                    <div class="text-xs text-gray-600">Deepgram TTS</div>
                                </div>
                            </div>
                            
                            <!-- Flow Arrows -->
                            <div class="mt-6">
                                <div class="flex justify-between items-center">
                                    <div class="text-xs text-gray-600">Audio Capture</div>
                                    <div class="flex-1 h-0.5 bg-sky-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Stream</div>
                                    <div class="flex-1 h-0.5 bg-blue-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Buffer</div>
                                    <div class="flex-1 h-0.5 bg-amber-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">STT</div>
                                    <div class="flex-1 h-0.5 bg-purple-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">AI</div>
                                    <div class="flex-1 h-0.5 bg-indigo-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Response</div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>WebRTC Pipeline:</strong> Complete browser-based voice processing from audio capture through Deepgram STT transcription to AI-generated responses with Redis session management.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">WebRTC Components</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ <strong>MediaRecorder API:</strong> Browser audio recording</li>
                                <li>‚Ä¢ <strong>WebSocket:</strong> Real-time communication via Socket.IO</li>
                                <li>‚Ä¢ <strong>Redis Session:</strong> Audio buffer storage</li>
                                <li>‚Ä¢ <strong>WebM Format:</strong> Native browser audio format</li>
                                <li>‚Ä¢ <strong>Base64 Encoding:</strong> Audio data transmission</li>
                                <li>‚Ä¢ <strong>Deepgram STT:</strong> Real-time speech-to-text</li>
                                <li>‚Ä¢ <strong>Session Management:</strong> User state tracking</li>
                                <li>‚Ä¢ <strong>Audio Buffer:</strong> Redis storage for playback</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Processing Flow</h4>
                            <ol class="text-sm text-gray-600 space-y-1">
                                <li>1. User clicks record button in browser</li>
                                <li>2. WebRTC MediaRecorder captures audio</li>
                                <li>3. Audio chunks sent via Socket.IO WebSocket</li>
                                <li>4. Server stores audio in Redis session buffer</li>
                                <li>5. User stops recording</li>
                                <li>6. Complete WebM blob sent to server</li>
                                <li>7. Deepgram STT transcribes audio</li>
                                <li>8. LangGraph agent processes request</li>
                                <li>9. Deepgram TTS generates response</li>
                                <li>10. Audio response played in browser</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Twilio Voice Interface -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Twilio Voice Interface</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The Convonet assistant provides complete voice interaction through Twilio integration, 
                        supporting natural language commands for team collaboration and task management with 
                        Amazon Polly.Amy voice and barge-in capabilities for interruption.
                    </p>
                    
                    <!-- Voice Processing Pipeline -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Voice Processing Pipeline</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                <!-- Speech Input -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-blue-100 border-2 border-blue-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-blue-800 font-bold text-sm">üé§</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Speech Input</div>
                                    <div class="text-xs text-gray-600">Twilio Voice</div>
                                </div>
                                
                                <!-- Speech Recognition -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-green-100 border-2 border-green-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-green-800 font-bold text-sm">üëÇ</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Speech-to-Text</div>
                                    <div class="text-xs text-gray-600">Twilio STT</div>
                                </div>
                                
                                <!-- LangGraph Agent -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-purple-100 border-2 border-purple-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-purple-800 font-bold text-sm">üß†</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">LangGraph Agent</div>
                                    <div class="text-xs text-gray-600">AI Processing</div>
                                </div>
                                
                                <!-- TTS -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-orange-100 border-2 border-orange-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-orange-800 font-bold text-sm">üó£Ô∏è</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Text-to-Speech</div>
                                    <div class="text-xs text-gray-600">Polly.Amy</div>
                                </div>
                                
                                <!-- Audio Output -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-red-100 border-2 border-red-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-red-800 font-bold text-sm">üîä</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Voice Response</div>
                                    <div class="text-xs text-gray-600">Twilio TTS</div>
                                </div>
                            </div>
                            
                            <!-- Flow Arrows -->
                            <div class="mt-6">
                                <div class="flex justify-between items-center">
                                    <div class="text-xs text-gray-600">User Speech</div>
                                    <div class="flex-1 h-0.5 bg-blue-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Recognition</div>
                                    <div class="flex-1 h-0.5 bg-green-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">AI Processing</div>
                                    <div class="flex-1 h-0.5 bg-orange-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Voice Output</div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>Voice Pipeline:</strong> Complete end-to-end voice processing from speech input to AI-generated voice response with real-time streaming.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Voice Command Examples</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h5 class="font-semibold text-gray-800 mb-3">Personal Productivity</h5>
                                    <ul class="text-sm text-gray-600 space-y-2">
                                        <li>üó£Ô∏è "Create a high priority todo to review the quarterly report"</li>
                                        <li>üó£Ô∏è "Add a reminder to call the dentist tomorrow at 2 PM"</li>
                                        <li>üó£Ô∏è "Schedule a meeting for next Friday from 2 to 3 PM"</li>
                                        <li>üó£Ô∏è "Show me all my pending todos"</li>
                                        <li>üó£Ô∏è "Mark the grocery shopping todo as completed"</li>
                                    </ul>
                                </div>
                                <div>
                                    <h5 class="font-semibold text-gray-800 mb-3">Team Collaboration</h5>
                                    <ul class="text-sm text-gray-600 space-y-2">
                                        <li>üó£Ô∏è "Create a hackathon team"</li>
                                        <li>üó£Ô∏è "What teams are available?"</li>
                                        <li>üó£Ô∏è "Who are the members of the development team?"</li>
                                        <li>üó£Ô∏è "Create a high priority todo for the dev team"</li>
                                        <li>üó£Ô∏è "Add admin@convonet.com to the hackathon team as owner"</li>
                                        <li>üó£Ô∏è "Assign a code review task to John in the dev team"</li>
                                        <li>üó£Ô∏è "Change john@example.com to admin role in the dev team"</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Voice Components</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ <strong>Speech-to-Text:</strong> Twilio speech recognition engine</li>
                                <li>‚Ä¢ <strong>Text-to-Speech:</strong> Amazon Polly.Amy voice</li>
                                <li>‚Ä¢ <strong>Barge-in:</strong> Interrupt AI while speaking</li>
                                <li>‚Ä¢ <strong>Speech Timeout:</strong> Auto detection (10s)</li>
                                <li>‚Ä¢ <strong>Agent Timeout:</strong> 30s processing time</li>
                                <li>‚Ä¢ <strong>Tool Timeout:</strong> 20s per MCP tool</li>
                                <li>‚Ä¢ <strong>Continuation:</strong> Multi-turn conversations</li>
                                <li>‚Ä¢ <strong>Exit Detection:</strong> Natural conversation ending</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Processing Flow</h4>
                            <ol class="text-sm text-gray-600 space-y-1">
                                <li>1. User calls Twilio number</li>
                                <li>2. Twilio webhook triggers /anthropic/convonet_todo/twilio/call</li>
                                <li>3. TwiML with &lt;Gather&gt; returned (10s timeout)</li>
                                <li>4. User speaks, Twilio recognizes speech</li>
                                <li>5. SpeechResult posted to /process_audio</li>
                                <li>6. LangGraph agent processes (30s timeout)</li>
                                <li>7. MCP tools execute (20s per tool)</li>
                                <li>8. Database & Calendar operations</li>
                                <li>9. Response converted to TwiML</li>
                                <li>10. Polly.Amy speaks response with barge-in</li>
                                <li>11. Conversation continues or ends</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Twilio Phone Integration -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Twilio Phone Integration</h3>
                <div class="bg-gray-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">
                        The Convonet assistant can be accessed via phone calls through Twilio integration, allowing users 
                        to interact with the AI assistant through voice calls from any phone number. The system uses TwiML 
                        and Gather for speech recognition with barge-in capability.
                    </p>
                    
                    <!-- Twilio Call Flow Architecture -->
                    <div class="mb-8">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800">Twilio Call Flow Architecture</h4>
                        <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-6 gap-4">
                                <!-- Phone Call -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-blue-100 border-2 border-blue-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-blue-800 font-bold text-sm">üìû</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Phone Call</div>
                                    <div class="text-xs text-gray-600">PSTN Network</div>
                                </div>
                                
                                <!-- Twilio -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-red-100 border-2 border-red-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-red-800 font-bold text-sm">T</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Twilio</div>
                                    <div class="text-xs text-gray-600">Voice API</div>
                                </div>
                                
                                <!-- Flask Webhook -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-green-100 border-2 border-green-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-green-800 font-bold text-sm">üåê</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Flask Webhook</div>
                                    <div class="text-xs text-gray-600">TwiML Response</div>
                                </div>
                                
                                <!-- MCP Client -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-purple-100 border-2 border-purple-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-purple-800 font-bold text-sm">üîå</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">MCP Client</div>
                                    <div class="text-xs text-gray-600">38 Tools</div>
                                </div>
                                
                                <!-- Database -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-orange-100 border-2 border-orange-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-orange-800 font-bold text-sm">‚öôÔ∏è</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">Database</div>
                                    <div class="text-xs text-gray-600">PostgreSQL</div>
                                </div>
                                
                                <!-- LangGraph Agent -->
                                <div class="text-center">
                                    <div class="w-16 h-16 bg-indigo-100 border-2 border-indigo-300 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <span class="text-indigo-800 font-bold text-sm">üß†</span>
                                    </div>
                                    <div class="text-sm font-medium text-gray-800">LangGraph Agent</div>
                                    <div class="text-xs text-gray-600">AI Processing</div>
                                </div>
                            </div>
                            
                            <!-- Flow Arrows -->
                            <div class="mt-6">
                                <div class="flex justify-between items-center">
                                    <div class="text-xs text-gray-600">Call Initiation</div>
                                    <div class="flex-1 h-0.5 bg-blue-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Webhook</div>
                                    <div class="flex-1 h-0.5 bg-green-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">Tool Execution</div>
                                    <div class="flex-1 h-0.5 bg-purple-400 mx-4"></div>
                                    <div class="text-xs text-gray-600">AI Processing</div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center">
                                <p class="text-sm text-gray-600">
                                    <strong>Call Flow:</strong> Phone ‚Üí Twilio ‚Üí Flask Webhook ‚Üí LangGraph Agent ‚Üí MCP Tools ‚Üí Database/Calendar ‚Üí TwiML Response
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Twilio Components</h4>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ <strong>Twilio Voice API:</strong> Handles incoming/outgoing calls</li>
                                <li>‚Ä¢ <strong>TwiML:</strong> XML-based call flow instructions</li>
                                <li>‚Ä¢ <strong>Gather Element:</strong> Collects speech input with barge-in</li>
                                <li>‚Ä¢ <strong>Say Element:</strong> Text-to-speech via Polly.Amy</li>
                                <li>‚Ä¢ <strong>Redirect Element:</strong> Call continuation logic</li>
                                <li>‚Ä¢ <strong>Webhook Endpoints:</strong> Flask routes for call handling</li>
                            </ul>
                        </div>
                        <div class="bg-white p-4 rounded border">
                            <h4 class="font-semibold text-gray-800 mb-2">Call Flow Process</h4>
                            <ol class="text-sm text-gray-600 space-y-1">
                                <li>1. User calls Twilio phone number</li>
                                <li>2. Twilio webhook triggers /twilio/call</li>
                                <li>3. TwiML with &lt;Gather&gt; returned</li>
                                <li>4. Greeting: "Hello! I'm your Convonet productivity assistant"</li>
                                <li>5. User speaks command</li>
                                <li>6. Speech posted to /process_audio</li>
                                <li>7. LangGraph agent processes request</li>
                                <li>8. MCP tools execute database operations</li>
                                <li>9. TwiML response with confirmation</li>
                                <li>10. Call continues or ends based on user</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="bg-white p-4 rounded border">
                        <h4 class="font-semibold text-gray-800 mb-2">Twilio Configuration</h4>
                        <div class="font-mono text-sm bg-gray-100 p-3 rounded">
                            <pre># Environment Variables
TWILIO_ACCOUNT_SID=your_account_sid
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_PHONE_NUMBER=+1234567890

# Webhook Endpoints
POST https://hjlees.com/anthropic/convonet_todo/twilio/call
POST https://hjlees.com/anthropic/convonet_todo/twilio/process_audio

# TwiML Response Example
&lt;Response&gt;
  &lt;Gather action="/anthropic/convonet_todo/twilio/process_audio" 
          method="POST" 
          input="speech" 
          speechTimeout="auto" 
          timeout="10" 
          bargeIn="true"&gt;
    &lt;Say voice="Polly.Amy"&gt;Hello! I'm your Convonet productivity assistant...&lt;/Say&gt;
  &lt;/Gather&gt;
  &lt;Say voice="Polly.Amy"&gt;I didn't hear anything. Please try again.&lt;/Say&gt;
  &lt;Redirect&gt;/anthropic/convonet_todo/twilio/call?is_continuation=true&lt;/Redirect&gt;
&lt;/Response&gt;</pre>
                        </div>
                    </div>
                    
                    <div class="mt-6 bg-blue-50 p-4 rounded border-l-4 border-blue-400">
                        <h4 class="font-semibold text-blue-800 mb-2">Twilio Setup Instructions</h4>
                        <div class="space-y-3">
                            <div>
                                <p class="text-sm text-blue-700 font-medium mb-1">Step 1: Configure Voice Settings</p>
                                <p class="text-sm text-blue-600">In Twilio Console ‚Üí Phone Numbers ‚Üí Active Numbers ‚Üí Select your number</p>
                            </div>
                            <div>
                                <p class="text-sm text-blue-700 font-medium mb-1">Step 2: Set Webhook URL</p>
                                <p class="text-sm text-blue-600">A CALL COMES IN: https://hjlees.com/anthropic/convonet_todo/twilio/call (HTTP POST)</p>
                            </div>
                            <div>
                                <p class="text-sm text-blue-700 font-medium mb-1">Step 3: Test Integration</p>
                                <p class="text-sm text-blue-600">Call your Twilio number and speak a command</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Code Examples -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Code Examples</h3>
                <div class="space-y-6">
                    
                    <!-- LangGraph Agent Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">LangGraph Agent (assistant_graph_todo.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from langchain_core.tools import BaseTool
from langchain_anthropic import ChatAnthropic
from langgraph.graph import StateGraph
from langgraph.prebuilt import ToolNode, tools_condition

class TodoAgent:
    def __init__(self, tools: List[BaseTool] = []):
        self.tools = tools
        self.llm = ChatAnthropic(
            model="claude-3-5-sonnet-20241022"
        ).bind_tools(tools=self.tools)
        self.graph = self.build_graph()

    def build_graph(self) -> CompiledStateGraph:
        builder = StateGraph(AgentState)
        
        def assistant(state: AgentState):
            response = self.llm.invoke(state.messages)
            state.messages.append(response)
            return state

        builder.add_node("assistant", assistant)
        builder.add_node("tools", ToolNode(self.tools))
        
        builder.set_entry_point("assistant")
        builder.add_conditional_edges("assistant", tools_condition)
        builder.add_edge("tools", "assistant")
        
        return builder.compile(checkpointer=InMemorySaver())

# Lazy initialization to avoid circular imports
_agent_instance = None

def get_agent():
    global _agent_instance
    if _agent_instance is None:
        _agent_instance = TodoAgent()
    return _agent_instance</code></pre>
                    </div>

                    <!-- Team Management API Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Team Management API (team_routes.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from flask import Blueprint, request, jsonify
from convonet.security.auth import require_auth
from convonet.models.user_models import User, Team, TeamMembership

team_bp = Blueprint('teams', __name__, url_prefix='/anthropic/api/teams')

@team_bp.route('/', methods=['POST'])
@require_auth
def create_team():
    """Create a new team"""
    data = request.get_json()
    user_id = request.current_user['user_id']
    
    with SessionLocal() as session:
        # Create team
        team = Team(
            name=data['name'],
            description=data.get('description', ''),
            is_active=True
        )
        session.add(team)
        session.commit()
        
        # Add creator as team owner
        membership = TeamMembership(
            team_id=team.id,
            user_id=user_id,
            role=TeamRole.OWNER
        )
        session.add(membership)
        session.commit()
        
        return jsonify({
            'message': 'Team created successfully',
            'team': {
                'id': str(team.id),
                'name': team.name
            }
        }), 201

@team_bp.route('/', methods=['GET'])
@require_auth
def get_user_teams():
    """Get all teams for the current user"""
    user_id = request.current_user['user_id']
    
    with SessionLocal() as session:
        results = session.query(TeamMembership, Team).join(
            Team, TeamMembership.team_id == Team.id
        ).filter(TeamMembership.user_id == user_id).all()
        
        teams = [{
            'id': str(team.id),
            'name': team.name,
            'role': membership.role.value
        } for membership, team in results]
        
        return jsonify({'teams': teams}), 200</code></pre>
                    </div>

                    <!-- MCP Team Tools Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">MCP Team Tools (db_todo.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from mcp.server.fastmcp import FastMCP

mcp = FastMCP("db_todo")

# Lazy import to avoid circular dependencies
def _lazy_import_team_models():
    global User, Team, TeamMembership, TeamRole
    if User is None:
        from convonet.models.user_models import User, Team, TeamMembership, TeamRole

@mcp.tool()
async def create_team_todo(
    title: str,
    team_id: str,
    description: Optional[str] = None,
    priority: TodoPriority = TodoPriority.MEDIUM,
    assignee_id: Optional[str] = None,
    due_date: Optional[datetime] = None,
) -> str:
    """Create a todo item for a specific team."""
    _lazy_import_team_models()
    check_database_available()
    
    with SessionLocal() as session:
        # Verify team exists
        team = session.query(Team).filter(Team.id == team_id).first()
        if not team:
            return f"Team with ID {team_id} not found."
        
        # Verify assignee is a team member
        if assignee_id:
            membership = session.query(TeamMembership).filter(
                TeamMembership.team_id == team_id,
                TeamMembership.user_id == assignee_id
            ).first()
            if not membership:
                return f"User is not a member of team '{team.name}'."
        
        # Create team todo
        new_todo = DBTodo(
            title=title,
            description=description,
            priority=priority.value,
            due_date=due_date or datetime.now(timezone.utc),
            team_id=team_id,
            assignee_id=assignee_id,
        )
        
        session.add(new_todo)
        session.commit()
        
        # Create Google Calendar event
        if get_calendar_service:
            calendar_service = get_calendar_service()
            event = calendar_service.events().insert(
                calendarId='primary',
                body={
                    'summary': f"[Team] {title}",
                    'description': f"Team: {team.name}\n{description or ''}",
                    'start': {'dateTime': due_date.isoformat(), 'timeZone': 'UTC'},
                    'end': {'dateTime': (due_date + timedelta(hours=1)).isoformat(), 'timeZone': 'UTC'}
                }
            ).execute()
            
            new_todo.google_calendar_event_id = event.get('id')
            session.commit()
        
        return f"‚úÖ Team todo created for {team.name}"

@mcp.tool()
async def get_teams() -> str:
    """Get all available teams."""
    _lazy_import_team_models()
    
    with SessionLocal() as session:
        teams = session.query(Team).filter(Team.is_active == True).all()
        result = "Available teams:\n"
        for team in teams:
            result += f"‚Ä¢ {team.name} (ID: {team.id})\n"
        return result

@mcp.tool()
async def get_team_members(team_id: str) -> str:
    """Get all members of a specific team."""
    _lazy_import_team_models()
    
    with SessionLocal() as session:
        team = session.query(Team).filter(Team.id == team_id).first()
        if not team:
            return f"Team not found."
        
        members = session.query(TeamMembership, User).join(
            User, TeamMembership.user_id == User.id
        ).filter(TeamMembership.team_id == team_id).all()
        
        result = f"Members of '{team.name}':\n"
        for membership, user in members:
            result += f"‚Ä¢ {user.full_name} - {membership.role.value}\n"
        return result</code></pre>
                    </div>

                    <!-- JWT Authentication Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">JWT Authentication (auth.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>import jwt
import bcrypt
from datetime import datetime, timedelta, timezone
from functools import wraps
from flask import request, jsonify

class JWTAuth:
    def __init__(self):
        self.secret_key = os.getenv('JWT_SECRET_KEY')
        self.algorithm = 'HS256'
        self.access_token_expire_minutes = 30
    
    def hash_password(self, password: str) -> str:
        """Hash password using bcrypt"""
        salt = bcrypt.gensalt()
        hashed = bcrypt.hashpw(password.encode('utf-8'), salt)
        return hashed.decode('utf-8')
    
    def verify_password(self, password: str, hashed: str) -> bool:
        """Verify password against hash"""
        return bcrypt.checkpw(password.encode('utf-8'), hashed.encode('utf-8'))
    
    def create_access_token(self, user_id: str, email: str, roles: list = None) -> str:
        """Create JWT access token"""
        payload = {
            'user_id': user_id,
            'email': email,
            'roles': roles or ['user'],
            'type': 'access',
            'exp': datetime.now(timezone.utc) + timedelta(minutes=30),
            'iat': datetime.now(timezone.utc)
        }
        return jwt.encode(payload, self.secret_key, algorithm=self.algorithm)
    
    def verify_token(self, token: str) -> Optional[Dict]:
        """Verify and decode JWT token"""
        try:
            return jwt.decode(token, self.secret_key, algorithms=[self.algorithm])
        except (jwt.ExpiredSignatureError, jwt.InvalidTokenError):
            return None
    
    def require_auth(self, f):
        """Decorator to require authentication"""
        @wraps(f)
        def decorated_function(*args, **kwargs):
            token = self.get_token_from_header()
            if not token:
                return jsonify({'error': 'No token provided'}), 401
            
            payload = self.verify_token(token)
            if not payload:
                return jsonify({'error': 'Invalid or expired token'}), 401
            
            request.current_user = {
                'user_id': payload['user_id'],
                'email': payload['email'],
                'roles': payload.get('roles', [])
            }
            
            return f(*args, **kwargs)
        return decorated_function

jwt_auth = JWTAuth()
require_auth = jwt_auth.require_auth</code></pre>
                    </div>

                    <!-- Twilio Integration Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Twilio Webhook Handler (routes.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from flask import Blueprint, request, Response
from twilio.twiml.voice_response import VoiceResponse, Gather
import asyncio

convonet_todo_bp = Blueprint('convonet_todo', __name__, url_prefix='/anthropic/convonet_todo')

@convonet_todo_bp.route('/twilio/call', methods=['POST'])
def twilio_call_webhook():
    """Handle incoming calls with barge-in capability"""
    is_continuation = request.args.get('is_continuation', 'false').lower() == 'true'
    response = VoiceResponse()
    
    gather = response.gather(
        input='speech',
        action='/anthropic/convonet_todo/twilio/process_audio',
        method='POST',
        speech_timeout='auto',
        timeout=10,
        barge_in=True
    )
    
    if not is_continuation:
        gather.say(
            "Hello! I'm your Convonet productivity assistant. How can I help you today?",
            voice='Polly.Amy'
        )
    
    response.say("I didn't hear anything. Please try again.", voice='Polly.Amy')
    response.redirect('/anthropic/convonet_todo/twilio/call?is_continuation=true')
    
    return Response(str(response), mimetype='text/xml')

@convonet_todo_bp.route('/twilio/process_audio', methods=['POST'])
def process_audio_webhook():
    """Process speech input from Twilio"""
    transcribed_text = request.form.get('SpeechResult', '')
    
    if not transcribed_text:
        response = VoiceResponse()
        gather = Gather(input='speech', action='/anthropic/convonet_todo/twilio/process_audio')
        gather.say("I didn't catch that. Could you please repeat?", voice='Polly.Amy')
        response.append(gather)
        return Response(str(response), mimetype='text/xml')
    
    # Check for exit phrases
    exit_phrases = ['exit', 'goodbye', 'bye', 'done']
    if any(phrase in transcribed_text.lower() for phrase in exit_phrases):
        response = VoiceResponse()
        response.say("Thank you! Have a great day!", voice='Polly.Amy')
        response.hangup()
        return Response(str(response), mimetype='text/xml')
    
    # Process with agent (30s timeout)
    try:
        agent_response = asyncio.run(
            asyncio.wait_for(_run_agent_async(transcribed_text), timeout=30.0)
        )
    except asyncio.TimeoutError:
        agent_response = "I'm taking too long. Please try a simpler request."
    
    # Return TwiML response
    response = VoiceResponse()
    gather = Gather(input='speech', action='/anthropic/convonet_todo/twilio/process_audio', barge_in=True)
    gather.say(agent_response, voice='Polly.Amy')
    response.append(gather)
    response.redirect('/anthropic/convonet_todo/twilio/call?is_continuation=true')
    
    return Response(str(response), mimetype='text/xml')</code></pre>
                    </div>

                    <!-- Deepgram WebRTC Integration Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Deepgram WebRTC Integration (deepgram_service.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from deepgram import DeepgramClient
import requests
import os
import tempfile

class DeepgramService:
    def __init__(self, api_key: Optional[str] = None):
        self.api_key = api_key or os.getenv('DEEPGRAM_API_KEY')
        self.client = DeepgramClient(api_key=self.api_key)
    
    def transcribe_audio_buffer(self, audio_buffer: bytes, language: str = "en") -> Optional[str]:
        """Transcribe audio buffer using Deepgram's HTTP API"""
        # Detect WebM/EBML header
        is_webm = len(audio_buffer) >= 4 and audio_buffer[:4] == b"\x1a\x45\xdf\xa3"
        
        if is_webm:
            # Send WebM directly to Deepgram
            with tempfile.NamedTemporaryFile(suffix='.webm', delete=False) as temp_file:
                temp_file.write(audio_buffer)
                temp_file_path = temp_file.name
            
            try:
                result = self._transcribe_file(temp_file_path, language)
                return result
            finally:
                os.unlink(temp_file_path)
        else:
            # Create WAV from PCM
            wav_file = self._create_wav_from_pcm(audio_buffer)
            try:
                result = self._transcribe_file(wav_file, language)
                return result
            finally:
                os.unlink(wav_file)
    
    def _transcribe_file(self, file_path: str, language: str) -> Optional[str]:
        """Transcribe file using Deepgram HTTP API"""
        url = "https://api.deepgram.com/v1/listen"
        
        params = {
            "model": "nova-2",
            "language": language,
            "smart_format": "true",
            "punctuate": "true"
        }
        
        headers = {
            "Authorization": f"Token {self.api_key}",
            "Content-Type": "audio/webm" if file_path.endswith('.webm') else "audio/wav"
        }
        
        with open(file_path, 'rb') as audio_file:
            response = requests.post(url, params=params, headers=headers, 
                                    data=audio_file.read(), timeout=30)
        
        if response.status_code == 200:
            result = response.json()
            if result.get("results") and result["results"].get("channels"):
                channel = result["results"]["channels"][0]
                if channel.get("alternatives"):
                    return channel["alternatives"][0].get("transcript", "").strip()
        return None</code></pre>
                    </div>

                    <!-- WebRTC Voice Server Example -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">WebRTC Voice Server (webrtc_voice_server.py)</h4>
                        <pre class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"><code>from flask_socketio import SocketIO, emit
from deepgram_webrtc_integration import transcribe_audio_with_deepgram_webrtc
import base64

@socketio.on('stop_recording', namespace='/voice')
def handle_stop_recording(data=None):
    """Handle WebRTC recording stop and process audio"""
    session_id = request.sid
    
    if data and 'audio' in data:
        # Decode complete WebM blob from client
        audio_buffer = base64.b64decode(data['audio'])
        
        # Store in Redis for audio player
        update_session(session_id, {'audio_buffer': data['audio']})
        
        # Transcribe with Deepgram
        transcribed_text = transcribe_audio_with_deepgram_webrtc(audio_buffer)
        
        if transcribed_text:
            # Process with LangGraph agent
            agent_response = asyncio.run(process_with_agent(
                transcribed_text, user_id, user_name
            ))
            
            # Generate TTS response using Deepgram
            from deepgram_service import get_deepgram_tts_service
            deepgram_tts = get_deepgram_tts_service()
            audio_bytes = deepgram_tts.synthesize_speech(
                text=agent_response,
                voice="aura-asteria-en"
            )
            
            audio_base64 = base64.b64encode(audio_bytes).decode('utf-8')
            
            # Send to client
            emit('agent_response', {
                'success': True,
                'text': agent_response,
                'audio': audio_base64
            }, namespace='/voice', room=session_id)</code></pre>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Usage Guide -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Usage Guide</h2>
            
            <!-- Setup and Deployment -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Setup and Deployment</h3>
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">1. Environment Setup</h4>
                            <div class="bg-gray-50 p-4 rounded">
                                <pre class="text-sm"><code># Install dependencies
pip install -r requirements.txt

# Set up environment variables
export ANTHROPIC_API_KEY="sk-ant-your-anthropic-key"
export DEEPGRAM_API_KEY="dg-your-deepgram-key"
export DB_URI="postgresql://user:pass@host/db"
export JWT_SECRET_KEY="your-super-secret-jwt-key"
export TWILIO_ACCOUNT_SID="your_twilio_sid"
export TWILIO_AUTH_TOKEN="your_twilio_token"
export TWILIO_PHONE_NUMBER="+1234567890"
export GOOGLE_OAUTH2_TOKEN_B64="base64_encoded_token"
export GOOGLE_CLIENT_ID="your_client_id"
export GOOGLE_CLIENT_SECRET="your_client_secret"
export DEEPGRAM_API_KEY="your_deepgram_api_key"
export FREEPBX_DOMAIN="34.26.59.14"
export REDIS_URL="redis://localhost:6379"</code></pre>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">2. Database Migration</h4>
                            <div class="bg-gray-50 p-4 rounded">
                                <pre class="text-sm"><code># Run team collaboration migration
python run_migration.py

# This creates:
# - users_anthropic table
# - teams_anthropic table
# - team_memberships_anthropic table
# - Adds team columns to todos_anthropic
# - Creates demo admin user (admin@convonet.com / admin123)</code></pre>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">3. Deepgram Configuration</h4>
                            <div class="bg-gray-50 p-4 rounded">
                                <pre class="text-sm"><code># Get Deepgram API key from: https://console.deepgram.com
export DEEPGRAM_API_KEY="your_deepgram_api_key"

# Deepgram supports WebRTC audio formats:
# - WebM (preferred for browser recording)
# - WAV (fallback for PCM conversion)</code></pre>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">4. Twilio Configuration</h4>
                            <div class="bg-gray-50 p-4 rounded">
                                <pre class="text-sm"><code># Configure Twilio phone number webhook:
Webhook URL: https://hjlees.com/anthropic/convonet_todo/twilio/call
HTTP Method: POST

# Test webhook:
curl -X POST https://hjlees.com/anthropic/convonet_todo/twilio/call \
  -d "CallSid=test123&From=+1234567890"</code></pre>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-semibold mb-3 text-gray-800">5. Start Production Service</h4>
                            <div class="bg-gray-50 p-4 rounded">
                                <pre class="text-sm"><code># Local development:
python app.py

# Production (Render.com):
gunicorn --worker-class gthread -w 1 --threads 4 --bind 0.0.0.0:$PORT start_simple:app

# Verify deployment:
curl https://hjlees.com/anthropic/convonet_todo/
curl https://hjlees.com/anthropic/team-dashboard</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Production Usage -->
            <div class="mb-12">
                <h3 class="text-2xl font-semibold mb-6 text-gray-800">Production Usage</h3>
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Team Dashboard</h4>
                        <p class="text-gray-700 mb-4">
                            Access the team dashboard at <code class="bg-gray-100 px-2 py-1 rounded">/anthropic/team-dashboard</code> 
                            to manage teams, members, and todos through a web interface.
                        </p>
                        <div class="bg-blue-50 p-4 rounded border-l-4 border-blue-400">
                            <p class="text-sm text-blue-800">
                                <strong>Demo Credentials:</strong> admin@convonet.com / admin123
                            </p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-gray-50 p-4 rounded">
                            <h5 class="font-semibold text-gray-800 mb-2">Twilio Voice Commands</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ "Create a high priority todo to review the quarterly report"</li>
                                <li>‚Ä¢ "Add a reminder to call mom tomorrow at 2 PM"</li>
                                <li>‚Ä¢ "Schedule a meeting for Friday from 2 to 3 PM"</li>
                                <li>‚Ä¢ "Show me all my pending todos"</li>
                                <li>‚Ä¢ "Mark the grocery shopping todo as completed"</li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <h5 class="font-semibold text-gray-800 mb-2">WebRTC Voice Commands</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ "Create a todo task to buy groceries"</li>
                                <li>‚Ä¢ "Add a reminder for team meeting"</li>
                                <li>‚Ä¢ "Transfer me to an agent"</li>
                                <li>‚Ä¢ "Create a team called Engineering"</li>
                                <li>‚Ä¢ "Show my todos"</li>
                            </ul>
                            <p class="text-xs text-gray-500 mt-2">
                                Access: <code>/anthropic/webrtc/voice-assistant</code>
                            </p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded">
                            <h5 class="font-semibold text-gray-800 mb-2">Team Commands</h5>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>‚Ä¢ "Create a high priority todo for the development team"</li>
                                <li>‚Ä¢ "What teams are available?"</li>
                                <li>‚Ä¢ "Who are the members of the development team?"</li>
                                <li>‚Ä¢ "Assign a code review task to John in the dev team"</li>
                                <li>‚Ä¢ "Create a demo team meeting on October 10th at 5 PM"</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Technical Highlights -->
    <section class="py-12 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Technical Highlights</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Circular Import Resolution -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg shadow">
                    <h4 class="text-lg font-semibold mb-3 text-blue-800">Circular Import Resolution</h4>
                    <p class="text-sm text-gray-700 mb-3">
                        Sophisticated lazy loading pattern to break circular dependencies between MCP servers and Flask routes.
                    </p>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>‚úÖ Lazy import of team models</li>
                        <li>‚úÖ Lazy agent initialization</li>
                        <li>‚úÖ Shared Base class pattern</li>
                        <li>‚úÖ extend_existing table args</li>
                    </ul>
                </div>
                
                <!-- Async Context Management -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg shadow">
                    <h4 class="text-lg font-semibold mb-3 text-green-800">Async Context Management</h4>
                    <p class="text-sm text-gray-700 mb-3">
                        Proper async/await patterns with context managers for MCP client and database connections.
                    </p>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>‚úÖ async with MultiServerMCPClient</li>
                        <li>‚úÖ asyncio.wait_for with timeouts</li>
                        <li>‚úÖ ExceptionGroup handling</li>
                        <li>‚úÖ 30s timeout for tool execution</li>
                    </ul>
                </div>
                
                <!-- Security Implementation -->
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg shadow">
                    <h4 class="text-lg font-semibold mb-3 text-purple-800">Enterprise Security</h4>
                    <p class="text-sm text-gray-700 mb-3">
                        Production-grade security with JWT authentication, bcrypt hashing, and role-based access control.
                    </p>
                    <ul class="text-xs text-gray-600 space-y-1">
                        <li>‚úÖ JWT HS256 tokens</li>
                        <li>‚úÖ Bcrypt password hashing</li>
                        <li>‚úÖ Role-based authorization</li>
                        <li>‚úÖ Auto token expiry handling</li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-8 bg-green-50 p-6 rounded-lg border-l-4 border-green-400">
                <h4 class="font-semibold text-green-800 mb-3">‚úÖ Production-Ready Features</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <h5 class="font-medium text-green-700 mb-2">Infrastructure</h5>
                        <ul class="text-sm text-green-600 space-y-1">
                            <li>‚úÖ Render.com cloud deployment</li>
                            <li>‚úÖ PostgreSQL database</li>
                            <li>‚úÖ Environment variable management</li>
                            <li>‚úÖ Build scripts & migrations</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="font-medium text-green-700 mb-2">Team Collaboration</h5>
                        <ul class="text-sm text-green-600 space-y-1">
                            <li>‚úÖ Multi-tenant architecture</li>
                            <li>‚úÖ Team member management</li>
                            <li>‚úÖ Task assignment</li>
                            <li>‚úÖ Role-based permissions</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="font-medium text-green-700 mb-2">AI Integration</h5>
                        <ul class="text-sm text-green-600 space-y-1">
                            <li>‚úÖ Voice-enabled AI agent</li>
                            <li>‚úÖ 38 MCP tools</li>
                            <li>‚úÖ Google Calendar sync</li>
                            <li>‚úÖ Natural language processing</li>
                        </ul>
                    </div>
                    <div>
                        <h5 class="font-medium text-green-700 mb-2">Voice Processing</h5>
                        <ul class="text-sm text-green-600 space-y-1">
                            <li>‚úÖ Twilio voice integration</li>
                            <li>‚úÖ WebRTC browser voice</li>
                            <li>‚úÖ Deepgram STT (95%+ accuracy)</li>
                            <li>‚úÖ Redis audio buffer</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- API Reference -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">API Reference</h2>
            
            <div class="space-y-6">
                <!-- Authentication API -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h4 class="text-xl font-semibold mb-4 text-gray-800">Authentication API</h4>
                    <div class="space-y-4">
                        <div class="border-l-4 border-blue-400 pl-4">
                            <div class="font-mono text-sm font-bold text-gray-800">POST /anthropic/api/auth/register</div>
                            <p class="text-sm text-gray-600 mt-1">Register a new user account</p>
                            <div class="mt-2 bg-gray-50 p-3 rounded">
                                <pre class="text-xs"><code>Request: {
  "email": "user@example.com",
  "username": "johndoe",
  "password": "secure123",
  "first_name": "John",
  "last_name": "Doe"
}

Response: {
  "message": "User registered successfully",
  "user": {...},
  "tokens": {
    "access_token": "eyJ...",
    "refresh_token": "eyJ..."
  }
}</code></pre>
                            </div>
                        </div>
                        
                        <div class="border-l-4 border-green-400 pl-4">
                            <div class="font-mono text-sm font-bold text-gray-800">POST /anthropic/api/auth/login</div>
                            <p class="text-sm text-gray-600 mt-1">Login and receive JWT tokens</p>
                            <div class="mt-2 bg-gray-50 p-3 rounded">
                                <pre class="text-xs"><code>Request: {
  "email": "user@example.com",
  "password": "secure123"
}

Response: {
  "message": "Login successful",
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "teams": [...]
  },
  "tokens": {
    "access_token": "eyJ...",
    "refresh_token": "eyJ..."
  }
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Team API -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h4 class="text-xl font-semibold mb-4 text-gray-800">Team Management API</h4>
                    <div class="space-y-4">
                        <div class="border-l-4 border-purple-400 pl-4">
                            <div class="font-mono text-sm font-bold text-gray-800">POST /anthropic/api/teams/</div>
                            <p class="text-sm text-gray-600 mt-1">Create a new team (requires auth)</p>
                            <div class="mt-2 bg-gray-50 p-3 rounded">
                                <pre class="text-xs"><code>Headers: {
  "Authorization": "Bearer eyJ..."
}

Request: {
  "name": "Development Team",
  "description": "Core development team"
}

Response: {
  "message": "Team created successfully",
  "team": {
    "id": "uuid",
    "name": "Development Team",
    "members_count": 1
  }
}</code></pre>
                            </div>
                        </div>
                        
                        <div class="border-l-4 border-orange-400 pl-4">
                            <div class="font-mono text-sm font-bold text-gray-800">GET /anthropic/api/teams/</div>
                            <p class="text-sm text-gray-600 mt-1">Get all teams for current user (requires auth)</p>
                            <div class="mt-2 bg-gray-50 p-3 rounded">
                                <pre class="text-xs"><code>Headers: {
  "Authorization": "Bearer eyJ..."
}

Response: {
  "teams": [
    {
      "id": "uuid",
      "name": "Development Team",
      "role": "owner",
      "members_count": 5
    }
  ]
}</code></pre>
                            </div>
                        </div>
                        
                        <div class="border-l-4 border-pink-400 pl-4">
                            <div class="font-mono text-sm font-bold text-gray-800">POST /anthropic/api/teams/{team_id}/members</div>
                            <p class="text-sm text-gray-600 mt-1">Add member to team (requires auth)</p>
                            <div class="mt-2 bg-gray-50 p-3 rounded">
                                <pre class="text-xs"><code>Request: {
  "user_id": "uuid",
  "role": "member"
}

Response: {
  "message": "Member added successfully"
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Performance & Deployment -->
    <section class="py-12 bg-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center mb-12">Performance & Deployment</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="bg-blue-50 p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold text-blue-600 mb-2">38</div>
                    <div class="text-sm text-blue-800 font-medium">MCP Tools</div>
                    <div class="text-xs text-gray-600 mt-1">Voice-enabled operations</div>
                </div>
                <div class="bg-green-50 p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold text-green-600 mb-2">30s</div>
                    <div class="text-sm text-green-800 font-medium">Agent Timeout</div>
                    <div class="text-xs text-gray-600 mt-1">Complex operations</div>
                </div>
                <div class="bg-purple-50 p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold text-purple-600 mb-2">20s</div>
                    <div class="text-sm text-purple-800 font-medium">Tool Timeout</div>
                    <div class="text-xs text-gray-600 mt-1">Per MCP tool execution</div>
                </div>
                <div class="bg-orange-50 p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold text-orange-600 mb-2">Multi-Tenant</div>
                    <div class="text-sm text-orange-800 font-medium">Architecture</div>
                    <div class="text-xs text-gray-600 mt-1">Teams, Users, Roles</div>
                </div>
            </div>
            
            <div class="mt-8 bg-gray-50 p-6 rounded-lg">
                <h4 class="font-semibold text-gray-800 mb-4">Deployment Stack</h4>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="text-center">
                        <div class="text-2xl mb-2">üöÄ</div>
                        <div class="text-sm font-medium text-gray-800">Render.com</div>
                        <div class="text-xs text-gray-600">Cloud Hosting</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl mb-2">üêò</div>
                        <div class="text-sm font-medium text-gray-800">PostgreSQL</div>
                        <div class="text-xs text-gray-600">Database</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl mb-2">üìû</div>
                        <div class="text-sm font-medium text-gray-800">Twilio</div>
                        <div class="text-xs text-gray-600">Voice API</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl mb-2">üìÖ</div>
                        <div class="text-sm font-medium text-gray-800">Google Calendar</div>
                        <div class="text-xs text-gray-600">OAuth2 Sync</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Back to Home -->
    <section class="py-8 bg-gray-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <a href="{{ url_for('home') }}" class="inline-flex items-center text-blue-600 hover:text-blue-800 font-medium">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Back to Home
            </a>
        </div>
    </section>
</div>
{% endblock %}
