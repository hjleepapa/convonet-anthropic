services:
  - type: web
    name: convonet-memory-optimized
    env: python
    plan: free
    buildCommand: |
      pip install -r requirements_memory_optimized.txt
    startCommand: |
      gunicorn --worker-class eventlet -w 1 --worker-connections 500 --max-requests 1000 --max-requests-jitter 100 --timeout 30 --keep-alive 2 --bind 0.0.0.0:$PORT passenger_wsgi_memory_optimized:application
    envVars:
      # Core Flask
      - key: FLASK_KEY
        value: your-secret-key-here
      - key: DB_URI
        value: your-database-uri-here
      
      # Redis (optional - will gracefully degrade if not available)
      - key: REDIS_HOST
        value: your-redis-host
      - key: REDIS_PORT
        value: 6379
      - key: REDIS_PASSWORD
        value: your-redis-password
      - key: REDIS_DB
        value: 0
      
      # Composio (optional - will gracefully degrade if not available)
      - key: COMPOSIO_API_KEY
        value: your-composio-api-key
      - key: COMPOSIO_PROJECT_ID
        value: your-composio-project-id
      
      # Twilio (optional)
      - key: TWILIO_ACCOUNT_SID
        value: your-twilio-account-sid
      - key: TWILIO_AUTH_TOKEN
        value: your-twilio-auth-token
      - key: TWILIO_PHONE_NUMBER
        value: your-twilio-phone-number
      
      # FreePBX (optional)
      - key: FREEPBX_HOST
        value: your-freepbx-host
      - key: FREEPBX_PORT
        value: 8080
      - key: FREEPBX_USERNAME
        value: your-freepbx-username
      - key: FREEPBX_PASSWORD
        value: your-freepbx-password
      
      # Rate Limiting (optional)
      - key: RATE_LIMIT_ENABLED
        value: "true"
      - key: RATE_LIMIT_STORAGE_URL
        value: "memory://"
      
      # Sentry (optional)
      - key: SENTRY_DSN
        value: your-sentry-dsn
      
      # Environment
      - key: RENDER_ENVIRONMENT
        value: production
      - key: RENDER
        value: true